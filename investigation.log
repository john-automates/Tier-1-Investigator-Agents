 They have also targeted Australian critical infrastructure sectors in addition to professional services and property development. The group gains access to victim systems through valid Remote Desktop Protocol (RDP) credentials, uses open-source tools and command-line scripting for discovery and credential harvesting, and exfiltrates victim data via File Transfer Protocol (FTP), Rclone, or Mega. BianLian group actors then extort money by threatening to release data if payment is not made. BianLian group originally employed a double-extortion model in which they encrypted victims\u2019 systems after exfiltrating the data; however, around January 2023, they shifted to primarily exfiltration-based extortion.\n\nFBI, CISA, and ACSC encourage critical infrastructure organizations and small- and medium-sized organizations to implement the recommendations in the Mitigations section of this advisory to reduce the likelihood and impact of BianLian and other ransomware incidents.\n\nDownload the PDF version of this report (710kb):\n\n[AA23-136A #StopRansomware: BianLian Ransomware Group](/sites/default/files/2023-05/aa23-136a_stopransomware_bianlian_ransomware_group_1.pdf)\n (PDF, 644.23 KB )\n\nFor a downloadable copy of IOCs (35kb), see:\n\n[AA23-136A STIX XML](/sites/default/files/2023-05/aa23-136a.stix_.xml)\n (XML, 34.72 KB )\n\nFor a downloadable copy of IOCs in JSON format, see [AA23-136A.stix.json](/sites/default/files/STIX/AA23-136A_StopRansomware_BianLian_Ransomware_Group \"JSON file for AA23-136A\")\n\n### Technical Details\n\n**Note:**\u00a0This advisory uses the\u00a0[MITRE ATT&CK\u00ae for Enterprise(link is external)](https://attack.mitre.org/versions/v13/matrices/enterprise/)\n framework, version 13. See the MITRE ATT&CK\u00ae Tactics and Techniques section for a table of the threat actors\u2019 activity mapped to MITRE ATT&CK\u00ae Tactics and Techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework, see CISA and MITRE ATT&CK\u2019s [Best Practices for MITRE ATT&CK Mapping](https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping)\n and CISA\u2019s [Decider Tool(link is external)](https://github.com/cisagov/Decider/)\n.\n\nBianLian is a ransomware developer, deployer, and data extortion cybercriminal group. FBI observed BianLian group targeting organizations in multiple U.S. critical infrastructure sectors since June 2022. In Australia, ACSC has observed BianLian group predominately targeting private enterprises, including one critical infrastructure organization. BianLian group originally employed a double-extortion model in which they exfiltrated financial, client, business, technical, and personal files for leverage and encrypted victims\u2019 systems. In 2023, FBI observed BianLian shift to primarily exfiltration-based extortion with victims\u2019 systems left intact, and ACSC observed BianLian shift exclusively to exfiltration-based extortion. BianLian actors warn of financial, business, and legal ramifications if payment is not made.\n\n#### Initial Access\n\nBianLian group actors gain initial access to networks by leveraging compromised Remote Desktop Protocol (RDP) credentials likely acquired from initial access brokers \\[[T1078(link is external)](https://attack.mitre.org/versions/v13/techniques/T1078/)\\\n\\],\\[[T1133(link is external)](https://attack.mitre.org/versions/v13/techniques/T1133/)\\\n\\] or via phishing \\[[T1566(link is external)](https://attack.mitre.org/versions/v13/techniques/T1566)\\\n\\].\n\n#### Command and Control\n\nBianLian group actors implant a custom backdoor specific to each victim written in Go (see the [Indicators of Compromise](#_Indicators_of_Compromise)\n Section for an example) \\[[T1587.001(link is external)](https://attack.mitre.org/versions/v13/techniques/T1587/001/)\\\n\\] and install remote management and access software\u2014e.g., TeamViewer, Atera Agent, SplashTop, AnyDesk\u2014for persistence and command and control \\[[T1105(link is external)](https://attack.mitre.org/versions/v13/techniques/T1105/)\\\n\\],\\[[T1219(link is external)](https://attack.mitre.org/versions/v13/techniques/T1219/)\\\n\\].\n\nFBI also observed BianLian group actors create and/or activate local administrator accounts \\[[T1136.001(link is external)](https://attack.mitre.org/versions/v13/techniques/T1136/001)\\\n\\] and change those account passwords \\[[T1098(link is external)](https://attack.mitre.org/versions/v13/techniques/T1098/)\\\n\\].\n\n#### Defense Evasion\n\nBianLian group actors use PowerShell \\[[T1059.001(link is external)](https://attack.mitre.org/versions/v13/techniques/T1059/001/)\\\n\\] and Windows Command Shell \\[[T1059.003(link is external)](https://attack.mitre.org/versions/v13/techniques/T1059/003/)\\\n\\] to disable antivirus tools \\[[T1562.001(link is external)](https://attack.mitre.org/versions/v13/techniques/T1562/001/)\\\n\\], specifically Windows defender and Anti-Malware Scan Interface (AMSI). BianLian actors modify the Windows Registry \\[[T1112(link is external)](https://attack.mitre.org/versions/v13/techniques/T1112)\\\n\\] to disable tamper protection for Sophos SAVEnabled, SEDEenabled, and SAVService services, which enables them to uninstall these services. See [Appendix: Windows PowerShell and Command Shell Activity](#_APPENDIX_:_)\n for additional information, including specific commands they have used.\n\n#### Discovery\n\nBianLian group actors use a combination of compiled tools, which they first download to the victim environment, to learn about the victim\u2019s environment. BianLian group actors have used:\n\n*   Advanced Port Scanner, a network scanner used to find open ports on network computers and retrieve versions of programs running on the detected ports \\[[T1046(link is external)](https://attack.mitre.org/versions/v13/techniques/T1046/)\\\n    \\].\n*   SoftPerfect Network Scanner (netscan.exe), a network scanner that can ping computers, scan ports, and discover shared folders \\[[T1135(link is external)](https://attack.mitre.org/versions/v13/techniques/T1135/)\\\n    \\].\n*   SharpShares to enumerate accessible network shares in a domain.\n*   PingCastle to enumerate Active Directory (AD) \\[[T1482(link is external)](https://attack.mitre.org/versions/v13/techniques/T1482/)\\\n    \\]. PingCastle provides an AD map to visualize the hierarchy of trust relationships.\n\nBianLian actors also use native Windows tools and Windows Command Shell to:\n\n*   Query currently logged-in users \\[[T1033(link is external)](https://attack.mitre.org/versions/v13/techniques/T1033/)\\\n    \\].\n*   Query the domain controller to identify:\n    *   All groups \\[[T1069.002(link is external)](https://attack.mitre.org/versions/v13/techniques/T1069/002/)\\\n        \\].\n    *   Accounts in the Domain Admins\u00a0and Domain Computers\u00a0groups \\[[1087.002(link is external)](https://attack.mitre.org/versions/v13/techniques/T1087/002/)\\\n        \\].\n    *   All users in the domain.\n*   Retrieve a list of all domain controllers and domain trusts.\n*   Identify accessible devices on the network \\[[T1018(link is external)](https://attack.mitre.org/versions/v13/techniques/T1018/)\\\n    \\].\n\nSee [Appendix: Windows PowerShell and Command Shell Activity](#_APPENDIX_:_)\n\u00a0for additional information, including specific commands they have used.\n\n#### Credential Access\n\nBianLian group uses valid accounts for lateral movement through the network and to pursue other follow-on activity. To obtain the credentials, BianLian group actors use Windows Command Shell to find unsecured credentials on the local machine \\[[T1552.001(link is external)](https://attack.mitre.org/versions/v13/techniques/T1552/001/)\\\n\\]. FBI also observed BianLian harvest credentials from the Local Security Authority Subsystem Service (LSASS) memory \\[[T1003.001(link is external)](https://attack.mitre.org/versions/v13/techniques/T1003/001/)\\\n\\], download RDP Recognizer (a tool that could be used to brute force RDP passwords or check for RDP vulnerabilities) to the victim system, and attempt to access an Active Directory domain database (NTDS.dit) \\[[T1003.003(link is external)](https://attack.mitre.org/versions/v13/techniques/T1003/003/)\\\n\\].\n\nIn one case, FBI observed BianLian actors use a portable executable version of an [Impacket(link is external)](https://attack.mitre.org/versions/v11/software/S0357/)\n tool (secretsdump.py) to move laterally to a domain controller and harvest credential hashes from it. **Note:** Impacket is a Python toolkit for programmatically constructing and manipulating network protocols. Through the Command Shell, an Impacket user with credentials can run commands on a remote device using the Windows management protocols required to support an enterprise network. Threat actors can run portable executable files on victim systems using local user rights, assuming the executable is not blocked by an application allowlist or antivirus solution.\n\nSee [Appendix: Windows PowerShell and Command Shell Activity](#_APPENDIX_:_)\n for additional information.\n\n#### Persistence and Lateral Movement\n\nBianLian group actors use PsExec and RDP with valid accounts for lateral movement \\[[T1021.001(link is external)](https://attack.mitre.org/versions/v13/techniques/T1021/001/)\\\n\\]. Prior to using RDP, BianLian actors used Command Shell and native Windows tools to add user accounts to the local Remote Desktop Users\u00a0group, modified the added account\u2019s password, and modified Windows firewall rules to allow incoming RDP traffic \\[[T1562.004(link is external)](https://attack.mitre.org/versions/v13/techniques/T1562/004/)\\\n\\]. See [Appendix: Windows PowerShell and Command Shell Activity](#_APPENDIX_:_)\n for additional information.\n\nIn one case, FBI found a forensic artifact (exp.exe) on a compromised system that likely exploits the Netlogon vulnerability ([CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)\n) and connects to a domain controller.\n\n#### Collection\n\nFBI observed BianLian group actors using malware (system.exe) that enumerates registry \\[[T1012(link is external)](https://attack.mitre.org/versions/v13/techniques/T1012/)\\\n\\] and files \\[[T1083(link is external)](https://attack.mitre.org/versions/v13/techniques/T1083/)\\\n\\] and copies clipboard data from users \\[[T1115(link is external)](https://attack.mitre.org/versions/v13/techniques/T1115/)\\\n\\].\n\n#### Exfiltration and Impact\n\nBianLian group actors search for sensitive files using PowerShell scripts (See [Appendix: Windows PowerShell and Command Shell Activity](#_APPENDIX_:_)\n) and exfiltrate them for data extortion. Prior to January 2023, BianLian actors encrypted files \\[[T1486(link is external)](https://attack.mitre.org/versions/v13/techniques/T1486/)\\\n\\] after exfiltration for double extortion.\n\nBianLian group uses File Transfer Protocol (FTP) \\[[T1048(link is external)](https://attack.mitre.org/versions/v13/techniques/T1048/)\\\n\\] and [Rclone(link is external)](https://attack.mitre.org/versions/v13/software/S1040/)\n, a tool used to sync files to cloud storage, to exfiltrate data \\[[T1537(link is external)](https://attack.mitre.org/versions/v13/techniques/T1537/)\\\n\\]. FBI observed BianLian group actors install Rclone and other files in generic and typically unchecked folders such as programdata\\\\vmware and music folders. ACSC observed BianLian group actors use Mega file-sharing service to exfiltrate victim data \\[[T1567.002(link is external)](https://attack.mitre.org/versions/v13/techniques/T1567/002/)\\\n\\].\n\nBianLian\u2019s encryptor (encryptor.exe) modified all encrypted files to have the .bianlian\u00a0extension. The encryptor created a ransom note, Look at this instruction.txt, in each affected directory (see Figure 1 for an example ransom note.) According to the ransom note, BianLian group specifically looked for, encrypted, and exfiltrated financial, client, business, technical, and personal files.\n\n_Figure 1: BianLian Sample Ransom Note (Look at this instruction.txt)_\n\nYour network systems were attacked and encrypted. Contact us in order to restore your data. Don't make any changes in your file structure: touch no files, don't try to recover by yourself, that may lead to it's complete loss.\n\n\u00a0To contact us you have to download \"tox\" messenger: https://qtox.github\\[.\\]io/\n\nAdd user with the following ID to get your instructions:\n\nA4B3B0845DA242A64BF17E0DB4278EDF4BF17E0DB4278EDF85855739667D3E2AE8B89D5439015F07E81D12D767FC\n\n\u00a0Alternative way: swikipedia@onionmail\\[.\\]org\n\n\u00a0Your ID: \\[Unique ID Assigned to Victim\\]\n\n\u00a0You should know that we have been downloading data from your network for a significant time before the attack: financial, client, business, post, technical and personal files.\n\nIn 10 days - it will be posted at our site http://bianlianlbc5an4kgnay3opdemgcryg2 gnay3opdemgcryg2kpfcbgczopmm3dnbz3uaunad\\[.\\]onion with links send to your clients, partners, competitors and news agencies, that will lead to a negative impact on your company: potential financial, business and reputational loses.\n\nIf a victim refuses to pay the ransom demand, BianLian group threatens to publish exfiltrated data to a leak site maintained on the Tor network. The ransom note provides the Tox ID A4B3B0845DA242A64BF17E0DB4278EDF85855739667D3E2AE8B89D5439015F07E81D12D767FC, which does not vary across victims. The Tox ID directs the victim organization to a Tox chat via\u00a0https://qtox.github\\[.\\]io\u00a0and includes an alternative contact email address (swikipedia@onionmail\\[.\\]org\u00a0or xxx@mail2tor\\[.\\]com). The email address is also the same address listed on the group\u2019s Tor site under the contact information section. Each victim company is assigned a unique identifier included in the ransom note. BianLian group receives payments in unique cryptocurrency wallets for each victim company.\n\nBianLian group engages in additional techniques to pressure the victim into paying the ransom; for example, printing the ransom note to printers on the compromised network. Employees of victim companies also reported receiving threatening telephone calls from individuals associated with BianLian group.\n\n### Indicators of Compromise (IOC)\n\nSee Table 1 for IOCs obtained from FBI investigations as of March 2023.\n\n|     |     |     |\n| --- | --- | --- |Table 1: BianLian Ransomware and Data Extortion Group IOCs\n| Name | **SHA-256 Hash** | **Description** |\n| --- | --- | --- |\n| **Name** def.exe | ****SHA-256 Hash**** 7b15f570a23a5c5ce8ff942da60834a9d0549ea3ea9f34f900a09331325df893 | ****Description**** Malware associated with BianLian intrusions, which is an example of a possible backdoor developed by BianLian group. |\n| **Name** encryptor.exe | ****SHA-256 Hash**** 1fd07b8d1728e416f897bef4f1471126f9b18ef108eb952f4b75050da22e8e43 | ****Description**** Example of a BianLian encryptor. |\n| **Name** exp.exe | ****SHA-256 Hash**** 0c1eb11de3a533689267ba075e49d93d55308525c04d6aff0d2c54d1f52f5500 | ****Description**** Possible NetLogon vulnerability (CVE-2020-1472) exploitation. |\n| **Name** system.exe | ****SHA-256 Hash**** 40126ae71b857dd22db39611c25d3d5dd0e60316b72830e930fba9baf23973ce | ****Description**** Enumerates registry and files. Reads clipboard data. |\n\n#### MITRE ATT&CK Techniques\n\nSee Table 2 for all referenced threat actor tactics and techniques in this advisory.\n\n| **Resource Development** |     |     |\n| --- | --- | --- |\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| ****Resource Development**** Develop Capabilities: Malware | ****Resource Development**** [T1587.001(link is external)](https://attack.mitre.org/versions/v13/techniques/T1587/001/) | ****Resource Development**** BianLian group actors developed a custom backdoor used in their intrusions. |\n\n| **Initial Access** |     |     |\n| --- | --- | --- |\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| ****Initial Access**** External Remote Services | ****Initial Access**** [T1133(link is external)](https://attack.mitre.org/versions/v13/techniques/T1133/) | ****Initial Access**** BianLian group actors used RDP with valid accounts as a means of gaining initial access and for lateral movement. |\n| ****Initial Access**** Phishing | ****Initial Access**** [T1566(link is external)](https://attack.mitre.org/versions/v13/techniques/T1566/) | ****Initial Access**** BianLian group actors used phishing to obtain valid user credentials for initial access. |\n| ****Initial Access**** Valid Accounts | ****Initial Access**** [T1078(link is external)](https://attack.mitre.org/versions/v13/techniques/T1078/) | ****Initial Access**** BianLian group actors used RDP with valid accounts as a means of gaining initial access and for lateral movement. |\n\n| **Execution** |     |     |\n| --- | --- | --- |\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| ****Execution**** Command and Scripting Interpreter: PowerShell | ****Execution**** [T1059.001(link is external)](https://attack.mitre.org/versions/v13/techniques/T1059/001/) | ****Execution**** BianLian group actors used PowerShell to disable AMSI on Windows. See [Appendix: Windows PowerShell and Command Shell Activity](#_APPENDIX_:_)<br> for additional information. |\n| ****Execution**** Command and Scripting Interpreter: Windows Command Shell | ****Execution**** [T1059.003(link is external)](https://attack.mitre.org/versions/v13/techniques/T1059/003/) | ****Execution**** BianLian group actors used Windows Command Shell to disable antivirus tools, for discovery, and to execute their tools on victim networks. See [Appendix: Windows PowerShell and Command Shell Activity](#_APPENDIX_:_)<br> for additional information. |\n| ****Execution**** Scheduled Task/Job: Scheduled Task | ****Execution**** [T1053.005(link is external)](https://attack.mitre.org/versions/v13/techniques/T1053/005/) | ****Execution**** BianLian group actors used a Scheduled Task run as SYSTEM (the highest privilege Windows accounts) to execute a Dynamic Link Library (DLL) file daily. See [Appendix: Windows PowerShell and Command Shell Activity](#_APPENDIX_:_)<br> for additional information. |\n\n| **Persistence** |     |     |\n| --- | --- | --- |\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| ****Persistence**** Account Manipulation | ****Persistence**** [T1098(link is external)](https://attack.mitre.org/versions/v13/techniques/T1098/) | ****Persistence****<br><br>BianLian group actors changed the password of an account they created.<br><br>BianLian actors modified the password of an account they added to the local Remote Desktop Users group. |\n| ****Persistence**** Create Account: Local Account | ****Persistence**** [T1136.001(link is external)](https://attack.mitre.org/versions/v13/techniques/T1136/001) | ****Persistence****<br><br>BianLian group actors created/activated a local administrator account.<br><br>BianLian group actors used net.exe to add a user account to the local Remote Desktop Users group. (See [Appendix: Windows PowerShell and Command Shell Activity](#_APPENDIX_:_)<br> for more information.) |\n\n| **Defense Evasion** |     |     |\n| --- | --- | --- |\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| ****Defense Evasion**** Modify Registry | ****Defense Evasion**** [T1112(link is external)](https://attack.mitre.org/versions/v13/techniques/T1112/) | ****Defense Evasion**** BianLian group actors modified the registry to\u00a0 disable user authentication for RDP connections, allow a user to receive help from Remote Assistance, and disable tamper protection for Sophos SAVEnabled, SEDEenabled, and SAVService services, which enables them to uninstall these services. |\n| ****Defense Evasion**** Impair Defenses: Disable or Modify Tools | ****Defense Evasion**** [T1562.001(link is external)](https://attack.mitre.org/versions/v13/techniques/T1562/001/) | ****Defense Evasion**** BianLian group actors disabled Windows defender, AMSI, and Sophos SAVEnabled and SEDEenabled tamper protection services. See [Appendix: Windows PowerShell and Command Shell Activity](#_APPENDIX_:_)<br> for additional information. |\n| ****Defense Evasion**** Impair Defenses: Disable or Modify System Firewall | ****Defense Evasion**** [T1562.004(link is external)](https://attack.mitre.org/versions/v13/techniques/T1562/004/) | ****Defense Evasion**** BianLian group actors added modified firewalls to allow RDP traffic by adding new rules to the Windows firewall that allow incoming RDP traffic and enable a pre-existing Windows firewall rule group named Remote Desktop. |\n\n| **Credential Access** |     |     |\n| --- | --- | --- |\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| ****Credential Access**** OS Credential Dumping: LSASS Memory | ****Credential Access**** [T1003.001(link is external)](https://attack.mitre.org/versions/v13/techniques/T1003/001/) | ****Credential Access**** BianLian group actors accessed credential material stored in the process memory of the LSASS. See Appendix: [Windows PowerShell and Command Shell Activity](#_APPENDIX_:_)<br> for additional information. |\n| ****Credential Access**** OS Credential Dumping: NTDS | ****Credential Access**** [T1003.003(link is external)](https://attack.mitre.org/versions/v13/techniques/T1003/003/) | ****Credential Access**** BianLian group actors attempted to access or create a copy of the Active Directory domain database in order to steal credential information and to obtain other information about domain members such as devices, users, and access rights. |\n| ****Credential Access**** Unsecured Credentials: Credentials In Files | ****Credential Access**** [T1552.001(link is external)](https://attack.mitre.org/versions/v13/techniques/T1552/001/) | ****Credential Access**** BianLian group actors searched local file systems and remote file shares for files containing insecurely stored credentials. |\n\n| **Discovery** |     |     |\n| --- | --- | --- |\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| ****Discovery**** Account Discovery: Domain Account | ****Discovery**** [1087.002(link is external)](https://attack.mitre.org/versions/v13/techniques/T1087/002/) | ****Discovery**** BianLian group actors queried the domain controller to identify accounts in the Domain Admins and Domain Computers groups. This information can help adversaries determine which domain accounts exist to aid in follow-on activity. |\n| ****Discovery**** Domain Trust Discovery | ****Discovery**** [T1482(link is external)](https://attack.mitre.org/versions/v13/techniques/T1482/) | ****Discovery****<br><br>BianLian group actors used PingCastle to enumerate the AD and map trust relationships.<br><br>BianLian group actors retrieved a list of domain trust relationships used to identify lateral movement opportunities in Windows multi-domain/forest environments. |\n| ****Discovery**** File and Directory Discovery | ****Discovery**** [T1083(link is external)](https://attack.mitre.org/versions/v13/techniques/T1083/) | ****Discovery**** BianLian group used malware (system.exe) that enumerates files. |\n| ****Discovery**** Network Service Discovery | ****Discovery**** [T1046(link is external)](https://attack.mitre.org/versions/v13/techniques/T1046/) | ****Discovery**** BianLian actors used Advanced Port Scanner and SoftPerfect Network Scanner to ping computers, scan ports, and identify program versions running on ports. |\n| ****Discovery**** Network Share Discovery | ****Discovery**** [T1135(link is external)](https://attack.mitre.org/versions/v13/techniques/T1135/) | ****Discovery****<br><br>BianLian actors used SoftPerfect Network Scanner, which can discover shared folders.<br><br>BianLian group actors used SharpShares to enumerate accessible network shares in a domain. |\n| ****Discovery**** Permission Groups Discovery: Domain Groups | ****Discovery**** [T1069.002(link is external)](https://attack.mitre.org/versions/v13/techniques/T1069/002/) | ****Discovery**** BianLian group actors queried the domain controller to identify groups. |\n| ****Discovery**** Query Registry | ****Discovery**** [T1012(link is external)](https://attack.mitre.org/versions/v13/techniques/T1012/) | ****Discovery**** BianLian group used malware (system.exe) that enumerates registry. |\n| ****Discovery**** Remote System Discovery | ****Discovery**** [T1018(link is external)](https://attack.mitre.org/versions/v13/techniques/T1018/) | ****Discovery****<br><br>BianLian group actors attempted to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for lateral movement.<br><br>BianLian group actors retrieved a list of domain controllers. |\n| ****Discovery**** System Owner User Discovery | ****Discovery**** [T1033(link is external)](https://attack.mitre.org/versions/v13/techniques/T1033/) | ****Discovery**** BianLian group actors queried currently logged-in users on a machine. |\n\n| **Lateral Movement** |     |     |\n| --- | --- | --- |\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| ****Lateral Movement**** Remote Services: Remote Desktop Protocol | ****Lateral Movement**** [T1021.001(link is external)](https://attack.mitre.org/versions/v13/techniques/T1021/001/) | ****Lateral Movement**** BianLian group actors used RDP with valid accounts for lateral movement. |\n\n| **Collection** |     |     |\n| --- | --- | --- |\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| ****Collection**** Clipboard Data | ****Collection**** [T1115(link is external)](https://attack.mitre.org/versions/v13/techniques/T1115/) | ****Collection**** BianLian group actors\u2019 malware collects data stored in the clipboard from users copying information within or between applications. |\n\n| **Command and Control** |     |     |\n| --- | --- | --- |\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| ****Command and Control**** Ingress Tool Transfer | ****Command and Control**** [T1105(link is external)](https://attack.mitre.org/versions/v13/techniques/T1105/) | ****Command and Control**** BianLian group actors transferred tools or other files from an external system into a compromised environment. |\n| ****Command and Control**** Remote Access Software | ****Command and Control**** [T1219(link is external)](https://attack.mitre.org/versions/v13/techniques/T1219/) | ****Command and Control**** BianLian group actors used legitimate desktop support and remote access software, such as TeamViewer, Atera, and SplashTop, to establish an interactive command and control channel to target systems within networks. |\n\n| **Exfiltration** |     |     |\n| --- | --- | --- |\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| ****Exfiltration**** Transfer Data to Cloud Account | ****Exfiltration**** [T1537(link is external)](https://attack.mitre.org/versions/v13/techniques/T1537/) | ****Exfiltration**** BianLian group actors used Rclone to exfiltrate data to a cloud account they control on the same service to avoid typical file transfers/downloads and network-based exfiltration detection. |\n| ****Exfiltration**** Exfiltration Over Alternative Protocol | ****Exfiltration**** [T1048(link is external)](https://attack.mitre.org/versions/v13/techniques/T1048/) | ****Exfiltration**** BianLian group actors exfiltrated data via FTP. |\n| ****Exfiltration**** Exfiltration Over Web Service: Exfiltration to Cloud Storage | ****Exfiltration**** [T1567.002(link is external)](https://attack.mitre.org/versions/v13/techniques/T1567/002/) | ****Exfiltration**** BianLian group actors exfiltrated data via Mega public file-sharing service. |\n\n| **Impact** |     |     |\n| --- | --- | --- |\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| ****Impact**** Data Encrypted for Impact | ****Impact**** [T1486(link is external)](https://attack.mitre.org/versions/v13/techniques/T1486/) | ****Impact**** BianLian group actors encrypted data on target systems. |\n\n### Mitigations\n\nFBI, CISA, and ACSC recommend organizations implement the mitigations below to improve your organization\u2019s cybersecurity posture on the basis of the threat actors\u2019 activity. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats and TTPs. Visit CISA\u2019s [Cross-Sector Cybersecurity Performance Goals](https://www.cisa.gov/cpg \"https://www.cisa.gov/cpg\")\n for more information on the CPGs, including additional recommended baseline protections.\n\n*   Reduce threat of malicious actors using remote access tools by:\n    *   **Auditing remote access tools** on your network to identify currently used and/or authorized software.\n    *   **Reviewing logs for execution of remote access software** to detect abnormal use of programs running as a portable executable \\[[CPG 2.T](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n        \\].\n    *   **Using security software to detect instances of remote access** software only being loaded in memory.\n    *   **Requiring authorized remote access solutions only be used from within your network over approved remote access solutions**, such as virtual private networks (VPNs) or virtual desktop interfaces (VDIs).\n    *   **Blocking both inbound and outbound connections on common remote access software ports and protocols** at the network perimeter.\n*   **Implement application controls to manage and control execution of software**, including allowlisting remote access programs.\n    *   Application controls should prevent installation and execution of portable versions of unauthorized remote access and other software. A properly configured application allowlisting solution will block any unlisted application execution. Allowlisting is important because antivirus solutions may fail to detect the execution of malicious portable executables when the files use any combination of compression, encryption, or obfuscation.\n\nSee NSA Cybersecurity Information sheet [Enforce Signed Software Execution Policies](https://media.defense.gov/2019/Sep/09/2002180334/-1/-1/0/Enforce%20Signed%20Software%20Execution%20Policies%20-%20Copy.pdf)\n for additional guidance.\n\n*   **Strictly limit the use of RDP and other remote desktop services**. If RDP is necessary, rigorously apply best practices, for example \\[[CPG 2.W](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n    \\]:\n    *   Audit the network for systems using RDP.\n    *   Close unused RDP ports.\n    *   Enforce account lockouts after a specified number of attempts.\n    *   Apply [phishing-resistant multifactor authentication (MFA)](https://www.cisa.gov/sites/default/files/publications/fact-sheet-implementing-phishing-resistant-mfa-508c.pdf)\n        .\n    *   Log RDP login attempts.\n*   **Disable command-line and scripting activities and permissions** \\[[CPG 2.N](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n    \\]**.**\n*   **Restrict the use of PowerShell**, using Group Policy, and only grant to specific users on a case-by-case basis. Typically, only those users or administrators who manage the network or Windows operating systems (OSs) should be permitted to use PowerShell \\[[CPG 2.E](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n    \\].\n*   **Update Windows PowerShell or PowerShell Core** to the latest version and uninstall all earlier PowerShell versions. Logs from Windows PowerShell prior to version 5.0 are either non-existent or do not record enough detail to aid in enterprise monitoring and incident response activities \\[[CPG 1.E, 2.S, 2.T](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n    \\].\n*   **Enable enhanced PowerShell logging** \\[[CPG 2.T, 2.U](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n    \\].\n    *   PowerShell logs contain valuable data, including historical OS and registry interaction and possible TTPs of a threat actor\u2019s PowerShell use.\n    *   Ensure PowerShell instances, using the latest version, have module, script block, and transcription logging enabled (enhanced logging).\n    *   The two logs that record PowerShell activity are the PowerShell\u00a0Windows Event Log and the PowerShell Operational\u00a0Log. FBI and CISA recommend turning on these two Windows Event Logs with a retention period of at least 180 days. These logs should be checked on a regular basis to confirm whether the log data has been deleted or logging has been turned off. Set the storage size permitted for both logs to as large as possible.\n*   **Configure the Windows Registry to require User Account Control (UAC) approval for any PsExec operations** requiring administrator privileges to reduce the risk of lateral movement by PsExec.\n*   **Review domain controllers, servers, workstations, and active directories** for new and/or unrecognized accounts \\[[CPG 4.C](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n    \\].\n*   **Audit user accounts** with administrative privileges and configure access controls according to the principle of least privilege \\[[CPG 2.E](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n    \\].\n*   Reduce the threat of credential compromise via the following**:**\n    *   **Place domain admin accounts in the protected users\u2019 group** to prevent caching of password hashes locally.\n    *   **Implement Credential Guard for Windows 10 and Server 2016**\u00a0(Refer to [Microsoft: Manage Windows Defender Credential Guard(link is external)](https://docs.microsoft.com/en-us/windows/security/identity-protection/credential-guard/credential-guard-manage \"Manage Windows Defender Credential Guard\")\n         for more information). For Windows Server 2012R2, enable Protected Process Light for Local Security Authority (LSA).\n    *   **Refrain from storing plaintext credentials in scripts**.\n*   **Implement time-based access for accounts set at the admin level and higher** \\[[CPG 2.A, 2.E](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n    \\]**.** For example, the Just-in-Time (JIT) access method provisions privileged access when needed and can support enforcement of the principle of least privilege (as well as the Zero Trust model). This is a process where a network-wide policy is set in place to automatically disable admin accounts at the Active Directory (AD) level when the account is not in direct need. Individual users may submit their requests through an automated process that grants them access to a specified system for a set timeframe when they need to support the completion of a certain task.\n\nIn addition, FBI, CISA, and ACSC recommend network defenders apply the following mitigations to limit potential adversarial use of common system and network discovery techniques and to reduce the impact and risk of compromise by ransomware or data extortion actors:\n\n*   **Implement a recovery plan** to maintain and retain multiple copies of sensitive or proprietary data and servers in a physically separate, segmented, and secure location (e.g., hard drive, storage device, or the cloud).\n*   **Maintain offline backups of data,** and regularly maintain backup and restoration (daily or weekly at minimum). By instituting this practice, an organization minimizes the impact of disruption to business practices as they will not be as severe and/or only have irretrievable data \\[[CPG 2.R](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n    \\]. ACSC recommends organizations follow the 3-2-1 backup strategy in which organizations have three copies of data (one copy of production data and two backup copies) on two different media such as disk and tape, with one copy kept off-site for disaster recovery.\n*   **Require all accounts** with password logins (e.g., service account, admin accounts, and domain admin accounts) **to comply** with [National Institute for Standards and Technology (NIST) standards](https://pages.nist.gov/800-63-3/)\n     for developing and managing password policies.\n    *   Use longer passwords consisting of at least 15 characters \\[[CPG 2.B](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n        \\].\n    *   Store passwords in hashed format using industry-recognized password managers.\n    *   Add password user \u201csalts\u201d to shared login credentials.\n    *   Avoid reusing passwords \\[[CPG 2.C](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n        \\].\n    *   Implement multiple failed login attempt account lockouts \\[[CPG 2.G](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n        \\].\n    *   Disable password \u201chints\u201d.\n    *   Refrain from requiring password changes more frequently than once per year.  \n        **Note:** NIST guidance suggests favoring longer passwords instead of requiring regular and frequent password resets. Frequent password resets are more likely to result in users developing password \u201cpatterns\u201d cyber criminals can easily decipher.\n    *   Require administrator credentials to install software.\n*   **Require phishing-resistant multifactor authentication** for all services to the extent possible, particularly for webmail, virtual private networks, and accounts that access critical systems \\[[CPG 2.H](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n    \\].\n*   **Keep all operating systems, software, and firmware up to date.** Timely patching is one of the most efficient and cost-effective steps an organization can take to minimize its exposure to cybersecurity threats. Organizations should patch vulnerable software and hardware systems within 24 to 48 hours from vulnerability disclosure. Prioritize patching [known exploited vulnerabilities](https://www.cisa.gov/known-exploited-vulnerabilities-catalog)\n     in internet-facing systems \\[[CPG 1.E](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n    \\].\n*   **Segment networks** to prevent the spread of ransomware. Network segmentation can help prevent the spread of ransomware by controlling traffic flows between\u2014and access to\u2014various subnetworks, restricting further lateral movement \\[[CPG 2.F](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n    \\].\n*   **Identify, detect, and investigate abnormal activity and potential traversal of the indicated ransomware with a networking monitoring tool.** To aid in detecting ransomware, implement a tool that logs and reports all network traffic, including lateral movement activity on a network. Endpoint detection and response (EDR) tools are particularly useful for detecting lateral connections, as they have insight into common and uncommon network connections for each host \\[[CPG 3.A](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n    \\].\n*   **Install, regularly update, and enable real time detection for antivirus software** on all hosts.\n*   **Disable unused** **ports** \\[[CPG 2.V](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n    \\]**.**\n*   **Consider adding an email banner to emails** received from outside your organization \\[[CPG 2.M](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n    \\].\n*   **Ensure all backup data is encrypted, immutable** (i.e., cannot be altered or deleted), and covers the entire organization\u2019s data infrastructure \\[[CPG 2.K, 2.L, 2.R](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n    \\].\n\n#### Validate Security Controls\n\nIn addition to applying mitigations, FBI, CISA, and ACSC recommend exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&CK for Enterprise framework in this advisory. FBI, CISA, and ACSC recommend testing your existing security controls inventory to assess how they perform against the ATT&CK techniques described in this advisory.\n\nTo get started:\n\n1.  Select an ATT&CK technique described in this advisory (see Table 2).\n2.  Align your security technologies against the technique.\n3.  Test your technologies against the technique.\n4.  Analyze your detection and prevention technologies\u2019 performance.\n5.  Repeat the process for all security technologies to obtain a set of comprehensive performance data.\n6.  Tune your security program, including people, processes, and technologies, based on the data generated by this process.\n\nFBI, CISA, and ACSC recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&CK techniques identified in this advisory.\n\n### RESOURCES\n\n*   [Stopransomware.gov](https://www.stopransomware.gov/)\n    , a whole-of-government approach with one central location for U.S. ransomware resources and alerts.\n*   [cyber.gov.au(link is external)](https://www.cyber.gov.au/)\n     for the Australian Government\u2019s central location to report cyber incidents, including ransomware, and to see advice and alerts. The site also provides ransomware advisories for businesses and organizations to help mitigate cyber threats.\n*   [CISA-Multi-State Information Sharing and Analysis Center (MS-ISAC) Joint Ransomware Guide](https://www.cisa.gov/sites/default/files/2023-01/CISA_MS-ISAC_Ransomware%20Guide_S508C.pdf)\n     for guidance on mitigating and responding to a ransomware attack\n*   For no-cost cyber hygiene services for U.S. organizations, \u00a0[Cyber Hygiene Services](https://www.cisa.gov/cyber-hygiene-services)\n     and [Ransomware Readiness Assessment(link is external)](https://github.com/cisagov/cset/releases/tag/v10.3.0.0)\n    .\n\n### Reporting\n\nThe FBI is seeking any information that can be shared, including boundary logs showing communication to and from foreign IP addresses, a sample ransom note, communications with BianLian actors, Bitcoin wallet information, decryptor files, and/or a benign sample of an encrypted file. The FBI and CISA do not encourage paying ransom, as payment does not guarantee victim files will be recovered. Furthermore, payment may also embolden adversaries to target additional organizations, encourage other criminal actors to engage in the distribution of ransomware, and/or fund illicit activities. Regardless of whether you or your organization have decided to pay the ransom, the FBI and CISA urge you to promptly report ransomware incidents to a [local FBI Field Office](https://www.fbi.gov/contact-us/field-offices)\n or CISA at [cisa.gov/report](https://us-cert.cisa.gov/report)\n. Australian organizations that have been impacted or require assistance in regard to a ransomware incident can contact ACSC via 1300 CYBER1 (1300 292 371) or by submitting a report [cyber.gov.au(link is external)](https://www.cyber.gov.au/report-and-recover/report)\n.\n\n### Acknowledgements\n\nMicrosoft and Sophos contributed to this advisory.\n\nAPPENDIX: WINDOWS PowerSHell and COMMAND SHELL ACTIVITY\n-------------------------------------------------------\n\nThrough FBI investigations as of March 2023, FBI has observed BianLian actors use the commands in Table 3. ACSC has observed BianLian actors use some of the same commands.\n\n|     |     |\n| --- | --- |Table 3: PowerShell and Windows Command Shell Activity\n| _**Command**_ | _**Use**_ |\n| --- | --- |\n| **_**Command**_** \\[Ref\\].Assembly.GetType(\u2018System.Management.Automation.AmsiUtils\u2019).GetField(\u2018amsiInitFailed\u2019,\u2019NonPublic,\\* Static\u2019).SetValue($null,$true) | **_**Use**_** Disables the AMSI on Windows. AMSI is a built-in feature on Windows 10 and newer that provides an interface for anti-malware scanners to inspect scripts prior to execution. When AMSI is disabled, malicious scripts may bypass antivirus solutions and execute undetected. |\n| **_**Command**_** cmd.exe /Q /c for /f \u201ctokens=1,2 delims= \u201c ^%A in (\u2018\u201dtasklist /fi \u201cImagename eq lsass.exe\u201d \\| find \u201clsass\u201d\u201d\u2019) do rundll32.exe C:\\\\windows\\\\System32\\\\comsvcs.dll, MiniDump ^%B \\\\Windows\\\\Temp\\\\<file>.csv full | **_**Use**_** Creates a memory dump lsass.exe\u00a0process and saves it as a CSV file[https://attack.mitre.org/versions/v12/techniques/T1003/001/(link is external)](https://attack.mitre.org/versions/v12/techniques/T1003/001/)<br>.\u00a0 BianLian actors used it to harvest credentials from lsass.exe. |\n| **_**Command**_** cmd.exe /Q /c net user <admin> /active:yes 1> \\\\\\\\127.0.0.1\\\\C$\\\\Windows\\\\Temp\\\\<folder> 2>&1 | **_**Use**_** Activates the local Administrator account. |\n| **_**Command**_** cmd.exe /Q /c net user \"<admin>\"<password> 1> \\\\\\\\127.0.0.1\\\\C$\\\\Windows\\\\Temp\\\\<folder> 2>&1 | **_**Use**_** Changes the password of the newly activated local Administrator account. |\n| **_**Command**_** cmd.exe /Q /c quser 1> \\\\\\\\127.0.0.1\\\\C$\\\\Windows\\\\Temp\\\\<folder> 2>&1 | **_**Use**_** Executes quser.exe\u00a0to query the currently logged-in users on a machine. The command is provided arguments to run quietly and exit upon completion, and the output is directed to the \\\\Windows\\\\Temp\u00a0directory. |\n| **_**Command**_** dism.exe /online /Disable-Feature /FeatureName:Windows-Defender /Remove /NoRestart | **_**Use**_** Using the Deployment Image Servicing and Management (DISM) executable file, removes the Windows Defender feature. |\n| **_**Command**_** dump.exe -no-pass -just-dc user.local/<fileserver.local>\\\\@<local\\_ip> | **_**Use**_** Executes secretsdump.py, a Portable Executable version of an Impacket tool. Used to dump password hashes from domain controllers. |\n| **_**Command**_** exp.exe -n <fileserver.local> -t <local\\_ip> | **_**Use**_** Possibly attempted exploitation of the NetLogon vulnerability (CVE-2020-1472). |\n| **_**Command**_** findstr /spin \"password\" \\*.\\* >C:\\\\Users\\\\training\\\\Music\\\\<file>.txt | **_**Use**_** Searches for the string password\u00a0in all files in the current directory and its subdirectories and puts the output to a file. |\n| **_**Command**_** ldap.exe -u user\\\\<user> -p <password> ldap://<local\\_ip> | **_**Use**_** Connects to the organization\u2019s Lightweight Directory Access Protocol (LDAP) server. |\n| **_**Command**_** logoff | **_**Use**_** Logs off the current user from a Windows session. Can be used to log off multiple users at once. |\n| **_**Command**_** mstsc | **_**Use**_** Launches Microsoft Remote Desktop Connection client application in Windows. |\n| **_**Command**_** net group /domain | **_**Use**_** Retrieves a list of all groups from the domain controller. |\n| **_**Command**_** net group 'Domain Admins' /domain | **_**Use**_** Queries the domain controller to retrieve a list of all accounts from Domain Admins\u00a0group. |\n| **_**Command**_** net group 'Domain Computers' /domain | **_**Use**_** Queries the domain controller to retrieve a list of all accounts from Domain Computers\u00a0group. |\n| **_**Command**_** net user /domain | **_**Use**_** Queries the domain controller to retrieve a list of all users in the domain. |\n| **_**Command**_** net.exe localgroup \"Remote Desktop Users\" <user> /add | **_**Use**_** Adds a user account to the local Remote Desktop Users\u00a0group. |\n| **_**Command**_** net.exe user <admin> <password> /domain | **_**Use**_** Modifies the password for the specified account. |\n| **_**Command**_** netsh.exe advfirewall firewall add rule \"name=allow RemoteDesktop\" dir=in \\* protocol=TCP localport=<port num> action=allow | **_**Use**_** Adds a new rule to the Windows firewall that allows incoming RDP traffic. |\n| **_**Command**_** netsh.exe advfirewall firewall set rule \"group=remote desktop\" new enable=Yes | **_**Use**_** Enables the pre-existing Windows firewall rule group named Remote Desktop. This rule group allows incoming RDP traffic. |\n| **_**Command**_** nltest /dclist | **_**Use**_** Retrieves a list of domain controllers. |\n| **_**Command**_** nltest /domain\\_trusts | **_**Use**_** Retrieves a list of domain trusts. |\n| **_**Command**_** ping.exe -4 -n 1 \\* | **_**Use**_** Sends a single ICMP echo request packet to all devices on the local network using the IPv4 protocol. The output of the command will show if the device is reachable or not. |\n| **_**Command**_** quser; (\\[adsisearcher\\]\"(ObjectClass=computer)\").FindAll().count;(\\[adsisearcher\\]\"(ObjectClass=user)\").FindAll().count;\\[Security.Principal.WindowsIdentity\\]::GetCurrent() \\| select name;net user \"$env:USERNAME\" /domain; (Get-WmiObject -class Win32\\_OperatingSystem).Caption; Get-WmiObject -Namespace root\\\\cimv2 -Class Win32\\_ComputerSystem; net group \"domain admins\" /domain; nltest /dclist:; nltest /DOMAIN\\_TRUSTS | **_**Use**_** Lists the current Windows identity for the logged-in user and displays the user's name. Uses the Active Directory Services Interface (ADSI) to search for all computer and user objects in the domain and returns counts of the quantities found. Lists information about the current user account from the domain, such as the user's name, description, and group memberships. Lists information about the operating system installed on the local computer. Lists information about the \"Domain Admins\" group from the domain. Lists all domain controllers in the domain. Displays information about domain trusts. |\n| **_**Command**_** reg.exe add \"HKEY\\_LOCAL\\_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Terminal \\* Server\\\\WinStations\\\\RDP-Tcp\" /v UserAuthentication /t REG\\_DWORD /d 0 /f | **_**Use**_** Adds/overwrites a new Registry value to disable user authentication for RDP connections. |\n| **_**Command**_** reg.exe add \"HKEY\\_LOCAL\\_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Terminal Server\" /\\* v fAllowToGetHelp /t REG\\_DWORD /d 1 /f | **_**Use**_** Adds/overwrites a new Registry value to allow a user to receive help from Remote Assistance. |\n| **_**Command**_** reg.exe add \"HKEY\\_LOCAL\\_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\Sophos Endpoint \\* Defense\\\\TamperProtection\\\\Config\" /t REG\\_DWORD /v SAVEnabled /d 0 /f | **_**Use**_** Adds/overwrites a new Registry value to disable tamper protection for Sophos antivirus named SAVEnabled. |\n| **_**Command**_** reg.exe add \"HKEY\\_LOCAL\\_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\Sophos Endpoint \\* Defense\\\\TamperProtection\\\\Config\" /t REG\\_DWORD /v SEDEnabled /d 0 /f | **_**Use**_** Adds/overwrites a new Registry value to disable tamper protection for Sophos antivirus named SEDEnabled. |\n| **_**Command**_** reg.exe ADD \\* HKEY\\_LOCAL\\_MACHINE\\\\SOFTWARE\\\\WOW6432Node\\\\Sophos\\\\SAVService\\\\TamperProtection /t REG\\_DWORD /v Enabled /d 0 /f | **_**Use**_** Adds/overwrites a new registry value to disable tamper protection for a Sophos antivirus service called SAVService. |\n| **_**Command**_** reg.exe copy hklm\\\\system\\\\CurrentControlSet\\\\services\\\\tvnserver \\* hklm\\\\system\\\\CurrentControlSet\\\\control\\\\safeboot\\\\network\\\\tvnserver /s /f | **_**Use**_** Copies the configuration settings for the tvnserver\u00a0service to a new location in the registry that will be used when the computer boots into Safe Mode with Networking. This allows the service to run with the same settings in Safe Mode as it does in normal mode. |\n| **_**Command**_** s.exe /threads:50 /ldap:all /verbose /outfile:c:\\\\users\\\\<user>\\\\desktop\\\\1.txt | **_**Use**_** Executes SharpShares. |\n| **_**Command**_** schtasks.exe /RU SYSTEM /create /sc ONCE /<user> /tr \"cmd.exe /crundll32.exe c:\\\\programdata\\\\netsh.dll,Entry\" /ST 04:43 | **_**Use**_** Creates a Scheduled Task run as SYSTEM\u00a0at 0443 AM. When the task is run, cmd.exe\u00a0uses crundll32.exe\u00a0to run the DLL file netsh.dll. (It is likely that netsh.dll is a malware file and not associated with netsh.) |\n| **_**Command**_** start-process PowerShell.exe -arg C:\\\\Users\\\\Public\\\\Music\\\\<file>.ps1 -WindowStyle Hidden | **_**Use**_** Executes a PowerShell script, while keeping the PowerShell window hidden from the user. |\n\n### Disclaimer\n\nThe information in this report is being provided \u201cas is\u201d for informational purposes only. FBI, CISA, and ACSC do not endorse any commercial product or service, including any subjects of analysis. Any reference to specific commercial products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by FBI, CISA, or ACSC.\n\nThis product is provided subject to this\u00a0[Notification](/notification \"Follow link\")\n\u00a0and this\u00a0[Privacy & Use](/privacy-policy \"Follow link\")\n\u00a0policy.\n\n### Tags\n\nTopics\n\n[Malware, Phishing, and Ransomware](/topics/cyber-threats-and-advisories/malware-phishing-and-ransomware)\n, [Cyber Threats and Advisories](/topics/cyber-threats-and-advisories)\n, [Critical Infrastructure Security and Resilience](/topics/critical-infrastructure-security-and-resilience)\n\nAudience\n\nSmall and Medium Businesses\n\nMITRE ATT&CK TTP\n\nCollection (TA0009), Command and Control (TA0011), Credential Access (TA0006), Defense Evasion (TA0005), Discovery (TA0007), Execution (TA0002), Exfiltration (TA0010), Impact (TA0040), Initial Access (TA0001), Lateral Movement (TA0008), Persistence (TA0003), Privilege Escalation (TA0004), Resource Development (TA0042)\n\nCo-Sealers and Partners\n\nFederal Bureau of Investigation, International\n\nPlease share your thoughts\n--------------------------\n\nWe recently updated our anonymous [product survey](https://cisasurvey.gov1.qualtrics.com/jfe/form/SV_9n4TtB8uttUPaM6?product=https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-136a)\n; we\u2019d welcome your feedback.\n\nRelated Advisories\n------------------\n\nSep 05, 2024\n\nCybersecurity Advisory | AA24-249A\n\n### [Russian Military Cyber Actors Target US and Global Critical Infrastructure](/news-events/cybersecurity-advisories/aa24-249a)\n\nAug 29, 2024\n\nCybersecurity Advisory | AA24-242A\n\n### [#StopRansomware: RansomHub Ransomware](/news-events/cybersecurity-advisories/aa24-242a)\n\nAug 28, 2024\n\nCybersecurity Advisory | AA24-241A\n\n### [Iran-based Cyber Actors Enabling Ransomware Attacks on US Organizations](/news-events/cybersecurity-advisories/aa24-241a)\n\nJul 25, 2024\n\nCybersecurity Advisory | AA24-207A\n\n### [North Korea Cyber Group Conducts Global Espionage Campaign to Advance Regime\u2019s Military and Nuclear Programs](/news-events/cybersecurity-advisories/aa24-207a)\n\n|     |     |\n| --- | --- |\n|     |     |\n\n|     |     |\n| --- | --- |\n|     |     |",
  "metadata": {
    "title": "#StopRansomware: BianLian Ransomware Group | CISALocksearchsearch(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)",
    "language": "en",
    "ogTitle": "#StopRansomware: BianLian Ransomware Group | CISA",
    "ogUrl": "https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-136a",
    "ogLocaleAlternate": [],
    "ogSiteName": "Cybersecurity and Infrastructure Security Agency CISA",
    "sourceURL": "https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-136a",
    "statusCode": 200
  }
}
Successfully scraped markdown for URL: https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-136a
Preparing prompt for summarization...
Query: encryptor.exe intitle:ransomware
Scraping JSON (first 500 characters): {
  "query": "encryptor.exe intitle:ransomware",
  "results": [
    {
      "title": "#StopRansomware: BianLian Ransomware Group | CISA",
      "url": "https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-136a",
      "content": "[Skip to main content](#main)\n\n![Dot gov](https://www.cisa.gov/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-dot-gov.svg)\n\n**Official websites use .gov**  \nA **.gov** website belongs to an official government organization in the United States.\...
Error during summarization: finish_reason: SAFETY
index: 0
safety_ratings {
  category: HARM_CATEGORY_SEXUALLY_EXPLICIT
  probability: NEGLIGIBLE
}
safety_ratings {
  category: HARM_CATEGORY_HATE_SPEECH
  probability: NEGLIGIBLE
}
safety_ratings {
  category: HARM_CATEGORY_HARASSMENT
  probability: NEGLIGIBLE
}
safety_ratings {
  category: HARM_CATEGORY_DANGEROUS_CONTENT
  probability: HIGH
}

Traceback (most recent call last):
  File "C:\Users\johnr\Documents\tools\agents\saint_con\pidgy\tools\website_crawler\crawl_website.py", line 176, in summarize_results       
    response = chat_session.send_message(prompt)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\johnr\Documents\tools\agents\saint_con\pidgy\myenv\Lib\site-packages\google\generativeai\generative_models.py", line 588, in send_message
    self._check_response(response=response, stream=stream)
  File "C:\Users\johnr\Documents\tools\agents\saint_con\pidgy\myenv\Lib\site-packages\google\generativeai\generative_models.py", line 616, in _check_response
    raise generation_types.StopCandidateException(response.candidates[0])
google.generativeai.types.generation_types.StopCandidateException: finish_reason: SAFETY
index: 0
safety_ratings {
  category: HARM_CATEGORY_SEXUALLY_EXPLICIT
  probability: NEGLIGIBLE
}
safety_ratings {
  category: HARM_CATEGORY_HATE_SPEECH
  probability: NEGLIGIBLE
}
safety_ratings {
  category: HARM_CATEGORY_HARASSMENT
  probability: NEGLIGIBLE
}
safety_ratings {
  category: HARM_CATEGORY_DANGEROUS_CONTENT
  probability: HIGH
}

Performing advanced search for query: encryptor.exe malware

Processing result 1: #StopRansomware: BianLian Ransomware Group | CISA - https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-136a
Scraping URL: https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-136a
Scrape parameters: {
  "formats": [
    "markdown"
  ]
}
Scrape response: {
  "markdown": "[Skip to main content](#main)\n\n![Dot gov](https://www.cisa.gov/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-dot-gov.svg)\n\n**Official websites use .gov**  \nA **.gov** website belongs to an official government organization in the United States.\n\n![HTTPS](https://www.cisa.gov/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-https.svg)\n\n**Secure .gov websites use HTTPS**  \nA **lock** (LockA locked padlock) or **https://** means you\u2019ve safely connected to the .gov website. Share sensitive information only on official, secure websites.\n\n[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools \"Free Cyber Services\")\n[#protect2024](/protect2024)\n[Secure Our World](/node/18883)\n[Shields Up](/node/8056)\n[Report A Cyber Issue](/report)\n\nShare:\n\n[](https://www.facebook.com/sharer/sharer.php?u=https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-136a&title=%23StopRansomware%3A%20BianLian%20Ransomware%20Group \"Share to Facebook\")\n[](https://twitter.com/intent/tweet?text=%23StopRansomware%3A%20BianLian%20Ransomware%20Group+https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-136a \"Share to X\")\n[](https://www.linkedin.com/sharing/share-offsite/?url=https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-136a \"Share to Linkedin\")\n[](mailto:?subject=%23StopRansomware%3A%20BianLian%20Ransomware%20Group&body=https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-136a \"Share to Email\")\n\nCybersecurity Advisory\n\n#StopRansomware: BianLian Ransomware Group\n==========================================\n\nRelease Date\n\nMay 16, 2023\n\nAlert Code\n\nAA23-136A\n\nRelated topics:\n\n[Malware, Phishing, and Ransomware](/topics/cyber-threats-and-advisories/malware-phishing-and-ransomware)\n, [Cyber Threats and Advisories](/topics/cyber-threats-and-advisories)\n, [Critical Infrastructure Security and Resilience](/topics/critical-infrastructure-security-and-resilience)\n\n#### Actions to take today to mitigate cyber threats from BianLian ransomware and data extortion:\u00a0\n\n1.  Strictly limit the use of RDP and other remote desktop services.\n2.  Disable command-line and scripting activities and permissions.\n3.  Restrict usage of PowerShell and update Windows PowerShell or PowerShell Core to the latest version.\n\n### Summary\n\n_**Note:** This joint Cybersecurity Advisory (CSA) is part of an ongoing #StopRansomware effort to publish advisories for network defenders that detail various ransomware variants and ransomware threat actors. These #StopRansomware advisories include recently and historically observed tactics, techniques, and procedures (TTPs) and indicators of compromise (IOCs) to help organizations protect against ransomware. Visit_ [_stopransomware.gov_](https://www.cisa.gov/stopransomware)\n _to see all #StopRansomware advisories and learn more about other ransomware threats and no-cost resources._\n\nThe Federal Bureau of Investigation (FBI), Cybersecurity and Infrastructure Security Agency (CISA), and Australian Cyber Security Centre (ACSC) are releasing this joint Cybersecurity Advisory to disseminate known BianLian ransomware and data extortion group IOCs and TTPs identified through FBI and ACSC investigations as of March 2023.\n\nBianLian is a ransomware developer, deployer, and data extortion cybercriminal group that has targeted organizations in multiple U.S. critical infrastructure sectors since June 2022. They have also targeted Australian critical infrastructure sectors in addition to professional services and property development. The group gains access to victim systems through valid Remote Desktop Protocol (RDP) credentials, uses open-source tools and command-line scripting for discovery and credential harvesting, and exfiltrates victim data via File Transfer Protocol (FTP), Rclone, or Mega. BianLian group actors then extort money by threatening to release data if payment is not made. BianLian group originally employed a double-extortion model in which they encrypted victims\u2019 systems after exfiltrating the data; however, around January 2023, they shifted to primarily exfiltration-based extortion.\n\nFBI, CISA, and ACSC encourage critical infrastructure organizations and small- and medium-sized organizations to implement the recommendations in the Mitigations section of this advisory to reduce the likelihood and impact of BianLian and other ransomware incidents.\n\nDownload the PDF version of this report (710kb):\n\n[AA23-136A #StopRansomware: BianLian Ransomware Group](/sites/default/files/2023-05/aa23-136a_stopransomware_bianlian_ransomware_group_1.pdf)\n (PDF, 644.23 KB )\n\nFor a downloadable copy of IOCs (35kb), see:\n\n[AA23-136A STIX XML](/sites/default/files/2023-05/aa23-136a.stix_.xml)\n (XML, 34.72 KB )\n\nFor a downloadable copy of IOCs in JSON format, see [AA23-136A.stix.json](/sites/default/files/STIX/AA23-136A_StopRansomware_BianLian_Ransomware_Group \"JSON file for AA23-136A\")\n\n### Technical Details\n\n**Note:**\u00a0This advisory uses the\u00a0[MITRE ATT&CK\u00ae for Enterprise(link is external)](https://attack.mitre.org/versions/v13/matrices/enterprise/)\n framework, version 13. See the MITRE ATT&CK\u00ae Tactics and Techniques section for a table of the threat actors\u2019 activity mapped to MITRE ATT&CK\u00ae Tactics and Techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework, see CISA and MITRE ATT&CK\u2019s [Best Practices for MITRE ATT&CK Mapping](https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping)\n and CISA\u2019s [Decider Tool(link is external)](https://github.com/cisagov/Decider/)\n.\n\nBianLian is a ransomware developer, deployer, and data extortion cybercriminal group. FBI observed BianLian group targeting organizations in multiple U.S. critical infrastructure sectors since June 2022. In Australia, ACSC has observed BianLian group predominately targeting private enterprises, including one critical infrastructure organization. BianLian group originally employed a double-extortion model in which they exfiltrated financial, client, business, technical, and personal files for leverage and encrypted victims\u2019 systems. In 2023, FBI observed BianLian shift to primarily exfiltration-based extortion with victims\u2019 systems left intact, and ACSC observed BianLian shift exclusively to exfiltration-based extortion. BianLian actors warn of financial, business, and legal ramifications if payment is not made.\n\n#### Initial Access\n\nBianLian group actors gain initial access to networks by leveraging compromised Remote Desktop Protocol (RDP) credentials likely acquired from initial access brokers \\[[T1078(link is external)](https://attack.mitre.org/versions/v13/techniques/T1078/)\\\n\\],\\[[T1133(link is external)](https://attack.mitre.org/versions/v13/techniques/T1133/)\\\n\\] or via phishing \\[[T1566(link is external)](https://attack.mitre.org/versions/v13/techniques/T1566)\\\n\\].\n\n#### Command and Control\n\nBianLian group actors implant a custom backdoor specific to each victim written in Go (see the [Indicators of Compromise](#_Indicators_of_Compromise)\n Section for an example) \\[[T1587.001(link is external)](https://attack.mitre.org/versions/v13/techniques/T1587/001/)\\\n\\] and install remote management and access software\u2014e.g., TeamViewer, Atera Agent, SplashTop, AnyDesk\u2014for persistence and command and control \\[[T1105(link is external)](https://attack.mitre.org/versions/v13/techniques/T1105/)\\\n\\],\\[[T1219(link is external)](https://attack.mitre.org/versions/v13/techniques/T1219/)\\\n\\].\n\nFBI also observed BianLian group actors create and/or activate local administrator accounts \\[[T1136.001(link is external)](https://attack.mitre.org/versions/v13/techniques/T1136/001)\\\n\\] and change those account passwords \\[[T1098(link is external)](https://attack.mitre.org/versions/v13/techniques/T1098/)\\\n\\].\n\n#### Defense Evasion\n\nBianLian group actors use PowerShell \\[[T1059.001(link is external)](https://attack.mitre.org/versions/v13/techniques/T1059/001/)\\\n\\] and Windows Command Shell \\[[T1059.003(link is external)](https://attack.mitre.org/versions/v13/techniques/T1059/003/)\\\n\\] to disable antivirus tools \\[[T1562.001(link is external)](https://attack.mitre.org/versions/v13/techniques/T1562/001/)\\\n\\], specifically Windows defender and Anti-Malware Scan Interface (AMSI). BianLian actors modify the Windows Registry \\[[T1112(link is external)](https://attack.mitre.org/versions/v13/techniques/T1112)\\\n\\] to disable tamper protection for Sophos SAVEnabled, SEDEenabled, and SAVService services, which enables them to uninstall these services. See [Appendix: Windows PowerShell and Command Shell Activity](#_APPENDIX_:_)\n for additional information, including specific commands they have used.\n\n#### Discovery\n\nBianLian group actors use a combination of compiled tools, which they first download to the victim environment, to learn about the victim\u2019s environment. BianLian group actors have used:\n\n*   Advanced Port Scanner, a network scanner used to find open ports on network computers and retrieve versions of programs running on the detected ports \\[[T1046(link is external)](https://attack.mitre.org/versions/v13/techniques/T1046/)\\\n    \\].\n*   SoftPerfect Network Scanner (netscan.exe), a network scanner that can ping computers, scan ports, and discover shared folders \\[[T1135(link is external)](https://attack.mitre.org/versions/v13/techniques/T1135/)\\\n    \\].\n*   SharpShares to enumerate accessible network shares in a domain.\n*   PingCastle to enumerate Active Directory (AD) \\[[T1482(link is external)](https://attack.mitre.org/versions/v13/techniques/T1482/)\\\n    \\]. PingCastle provides an AD map to visualize the hierarchy of trust relationships.\n\nBianLian actors also use native Windows tools and Windows Command Shell to:\n\n*   Query currently logged-in users \\[[T1033(link is external)](https://attack.mitre.org/versions/v13/techniques/T1033/)\\\n    \\].\n*   Query the domain controller to identify:\n    *   All groups \\[[T1069.002(link is external)](https://attack.mitre.org/versions/v13/techniques/T1069/002/)\\\n        \\].\n    *   Accounts in the Domain Admins\u00a0and Domain Computers\u00a0groups \\[[1087.002(link is external)](https://attack.mitre.org/versions/v13/techniques/T1087/002/)\\\n        \\].\n    *   All users in the domain.\n*   Retrieve a list of all domain controllers and domain trusts.\n*   Identify accessible devices on the network \\[[T1018(link is external)](https://attack.mitre.org/versions/v13/techniques/T1018/)\\\n    \\].\n\nSee [Appendix: Windows PowerShell and Command Shell Activity](#_APPENDIX_:_)\n\u00a0for additional information, including specific commands they have used.\n\n#### Credential Access\n\nBianLian group uses valid accounts for lateral movement through the network and to pursue other follow-on activity. To obtain the credentials, BianLian group actors use Windows Command Shell to find unsecured credentials on the local machine \\[[T1552.001(link is external)](https://attack.mitre.org/versions/v13/techniques/T1552/001/)\\\n\\]. FBI also observed BianLian harvest credentials from the Local Security Authority Subsystem Service (LSASS) memory \\[[T1003.001(link is external)](https://attack.mitre.org/versions/v13/techniques/T1003/001/)\\\n\\], download RDP Recognizer (a tool that could be used to brute force RDP passwords or check for RDP vulnerabilities) to the victim system, and attempt to access an Active Directory domain database (NTDS.dit) \\[[T1003.003(link is external)](https://attack.mitre.org/versions/v13/techniques/T1003/003/)\\\n\\].\n\nIn one case, FBI observed BianLian actors use a portable executable version of an [Impacket(link is external)](https://attack.mitre.org/versions/v11/software/S0357/)\n tool (secretsdump.py) to move laterally to a domain controller and harvest credential hashes from it. **Note:** Impacket is a Python toolkit for programmatically constructing and manipulating network protocols. Through the Command Shell, an Impacket user with credentials can run commands on a remote device using the Windows management protocols required to support an enterprise network. Threat actors can run portable executable files on victim systems using local user rights, assuming the executable is not blocked by an application allowlist or antivirus solution.\n\nSee [Appendix: Windows PowerShell and Command Shell Activity](#_APPENDIX_:_)\n for additional information.\n\n#### Persistence and Lateral Movement\n\nBianLian group actors use PsExec and RDP with valid accounts for lateral movement \\[[T1021.001(link is external)](https://attack.mitre.org/versions/v13/techniques/T1021/001/)\\\n\\]. Prior to using RDP, BianLian actors used Command Shell and native Windows tools to add user accounts to the local Remote Desktop Users\u00a0group, modified the added account\u2019s password, and modified Windows firewall rules to allow incoming RDP traffic \\[[T1562.004(link is external)](https://attack.mitre.org/versions/v13/techniques/T1562/004/)\\\n\\]. See [Appendix: Windows PowerShell and Command Shell Activity](#_APPENDIX_:_)\n for additional information.\n\nIn one case, FBI found a forensic artifact (exp.exe) on a compromised system that likely exploits the Netlogon vulnerability ([CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)\n) and connects to a domain controller.\n\n#### Collection\n\nFBI observed BianLian group actors using malware (system.exe) that enumerates registry \\[[T1012(link is external)](https://attack.mitre.org/versions/v13/techniques/T1012/)\\\n\\] and files \\[[T1083(link is external)](https://attack.mitre.org/versions/v13/techniques/T1083/)\\\n\\] and copies clipboard data from users \\[[T1115(link is external)](https://attack.mitre.org/versions/v13/techniques/T1115/)\\\n\\].\n\n#### Exfiltration and Impact\n\nBianLian group actors search for sensitive files using PowerShell scripts (See [Appendix: Windows PowerShell and Command Shell Activity](#_APPENDIX_:_)\n) and exfiltrate them for data extortion. Prior to January 2023, BianLian actors encrypted files \\[[T1486(link is external)](https://attack.mitre.org/versions/v13/techniques/T1486/)\\\n\\] after exfiltration for double extortion.\n\nBianLian group uses File Transfer Protocol (FTP) \\[[T1048(link is external)](https://attack.mitre.org/versions/v13/techniques/T1048/)\\\n\\] and [Rclone(link is external)](https://attack.mitre.org/versions/v13/software/S1040/)\n, a tool used to sync files to cloud storage, to exfiltrate data \\[[T1537(link is external)](https://attack.mitre.org/versions/v13/techniques/T1537/)\\\n\\]. FBI observed BianLian group actors install Rclone and other files in generic and typically unchecked folders such as programdata\\\\vmware and music folders. ACSC observed BianLian group actors use Mega file-sharing service to exfiltrate victim data \\[[T1567.002(link is external)](https://attack.mitre.org/versions/v13/techniques/T1567/002/)\\\n\\].\n\nBianLian\u2019s encryptor (encryptor.exe) modified all encrypted files to have the .bianlian\u00a0extension. The encryptor created a ransom note, Look at this instruction.txt, in each affected directory (see Figure 1 for an example ransom note.) According to the ransom note, BianLian group specifically looked for, encrypted, and exfiltrated financial, client, business, technical, and personal files.\n\n_Figure 1: BianLian Sample Ransom Note (Look at this instruction.txt)_\n\nYour network systems were attacked and encrypted. Contact us in order to restore your data. Don't make any changes in your file structure: touch no files, don't try to recover by yourself, that may lead to it's complete loss.\n\n\u00a0To contact us you have to download \"tox\" messenger: https://qtox.github\\[.\\]io/\n\nAdd user with the following ID to get your instructions:\n\nA4B3B0845DA242A64BF17E0DB4278EDF4BF17E0DB4278EDF85855739667D3E2AE8B89D5439015F07E81D12D767FC\n\n\u00a0Alternative way: swikipedia@onionmail\\[.\\]org\n\n\u00a0Your ID: \\[Unique ID Assigned to Victim\\]\n\n\u00a0You should know that we have been downloading data from your network for a significant time before the attack: financial, client, business, post, technical and personal files.\n\nIn 10 days - it will be posted at our site http://bianlianlbc5an4kgnay3opdemgcryg2 gnay3opdemgcryg2kpfcbgczopmm3dnbz3uaunad\\[.\\]onion with links send to your clients, partners, competitors and news agencies, that will lead to a negative impact on your company: potential financial, business and reputational loses.\n\nIf a victim refuses to pay the ransom demand, BianLian group threatens to publish exfiltrated data to a leak site maintained on the Tor network. The ransom note provides the Tox ID A4B3B0845DA242A64BF17E0DB4278EDF85855739667D3E2AE8B89D5439015F07E81D12D767FC, which does not vary across victims. The Tox ID directs the victim organization to a Tox chat via\u00a0https://qtox.github\\[.\\]io\u00a0and includes an alternative contact email address (swikipedia@onionmail\\[.\\]org\u00a0or xxx@mail2tor\\[.\\]com). The email address is also the same address listed on the group\u2019s Tor site under the contact information section. Each victim company is assigned a unique identifier included in the ransom note. BianLian group receives payments in unique cryptocurrency wallets for each victim company.\n\nBianLian group engages in additional techniques to pressure the victim into paying the ransom; for example, printing the ransom note to printers on the compromised network. Employees of victim companies also reported receiving threatening telephone calls from individuals associated with BianLian group.\n\n### Indicators of Compromise (IOC)\n\nSee Table 1 for IOCs obtained from FBI investigations as of March 2023.\n\n|     |     |     |\n| --- | --- | --- |Table 1: BianLian Ransomware and Data Extortion Group IOCs\n| Name | **SHA-256 Hash** | **Description** |\n| --- | --- | --- |\n| **Name** def.exe | ****SHA-256 Hash**** 7b15f570a23a5c5ce8ff942da60834a9d0549ea3ea9f34f900a09331325df893 | ****Description**** Malware associated with BianLian intrusions, which is an example of a possible backdoor developed by BianLian group. |\n| **Name** encryptor.exe | ****SHA-256 Hash**** 1fd07b8d1728e416f897bef4f1471126f9b18ef108eb952f4b75050da22e8e43 | ****Description**** Example of a BianLian encryptor. |\n| **Name** exp.exe | ****SHA-256 Hash**** 0c1eb11de3a533689267ba075e49d93d55308525c04d6aff0d2c54d1f52f5500 | ****Description**** Possible NetLogon vulnerability (CVE-2020-1472) exploitation. |\n| **Name** system.exe | ****SHA-256 Hash**** 40126ae71b857dd22db39611c25d3d5dd0e60316b72830e930fba9baf23973ce | ****Description**** Enumerates registry and files. Reads clipboard data. |\n\n#### MITRE ATT&CK Techniques\n\nSee Table 2 for all referenced threat actor tactics and techniques in this advisory.\n\n| **Resource Development** |     |     |\n| --- | --- | --- |\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| ****Resource Development**** Develop Capabilities: Malware | ****Resource Development**** [T1587.001(link is external)](https://attack.mitre.org/versions/v13/techniques/T1587/001/) | ****Resource Development**** BianLian group actors developed a custom backdoor used in their intrusions. |\n\n| **Initial Access** |     |     |\n| --- | --- | --- |\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| ****Initial Access**** External Remote Services | ****Initial Access**** [T1133(link is external)](https://attack.mitre.org/versions/v13/techniques/T1133/) | ****Initial Access**** BianLian group actors used RDP with valid accounts as a means of gaining initial access and for lateral movement. |\n| ****Initial Access**** Phishing | ****Initial Access**** [T1566(link is external)](https://attack.mitre.org/versions/v13/techniques/T1566/) | ****Initial Access**** BianLian group actors used phishing to obtain valid user credentials for initial access. |\n| ****Initial Access**** Valid Accounts | ****Initial Access**** [T1078(link is external)](https://attack.mitre.org/versions/v13/techniques/T1078/) | ****Initial Access**** BianLian group actors used RDP with valid accounts as a means of gaining initial access and for lateral movement. |\n\n| **Execution** |     |     |\n| --- | --- | --- |\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| ****Execution**** Command and Scripting Interpreter: PowerShell | ****Execution**** [T1059.001(link is external)](https://attack.mitre.org/versions/v13/techniques/T1059/001/) | ****Execution**** BianLian group actors used PowerShell to disable AMSI on Windows. See [Appendix: Windows PowerShell and Command Shell Activity](#_APPENDIX_:_)<br> for additional information. |\n| ****Execution**** Command and Scripting Interpreter: Windows Command Shell | ****Execution**** [T1059.003(link is external)](https://attack.mitre.org/versions/v13/techniques/T1059/003/) | ****Execution**** BianLian group actors used Windows Command Shell to disable antivirus tools, for discovery, and to execute their tools on victim networks. See [Appendix: Windows PowerShell and Command Shell Activity](#_APPENDIX_:_)<br> for additional information. |\n| ****Execution**** Scheduled Task/Job: Scheduled Task | ****Execution**** [T1053.005(link is external)](https://attack.mitre.org/versions/v13/techniques/T1053/005/) | ****Execution**** BianLian group actors used a Scheduled Task run as SYSTEM (the highest privilege Windows accounts) to execute a Dynamic Link Library (DLL) file daily. See [Appendix: Windows PowerShell and Command Shell Activity](#_APPENDIX_:_)<br> for additional information. |\n\n| **Persistence** |     |     |\n| --- | --- | --- |\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| ****Persistence**** Account Manipulation | ****Persistence**** [T1098(link is external)](https://attack.mitre.org/versions/v13/techniques/T1098/) | ****Persistence****<br><br>BianLian group actors changed the password of an account they created.<br><br>BianLian actors modified the password of an account they added to the local Remote Desktop Users group. |\n| ****Persistence**** Create Account: Local Account | ****Persistence**** [T1136.001(link is external)](https://attack.mitre.org/versions/v13/techniques/T1136/001) | ****Persistence****<br><br>BianLian group actors created/activated a local administrator account.<br><br>BianLian group actors used net.exe to add a user account to the local Remote Desktop Users group. (See [Appendix: Windows PowerShell and Command Shell Activity](#_APPENDIX_:_)<br> for more information.) |\n\n| **Defense Evasion** |     |     |\n| --- | --- | --- |\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| ****Defense Evasion**** Modify Registry | ****Defense Evasion**** [T1112(link is external)](https://attack.mitre.org/versions/v13/techniques/T1112/) | ****Defense Evasion**** BianLian group actors modified the registry to\u00a0 disable user authentication for RDP connections, allow a user to receive help from Remote Assistance, and disable tamper protection for Sophos SAVEnabled, SEDEenabled, and SAVService services, which enables them to uninstall these services. |\n| ****Defense Evasion**** Impair Defenses: Disable or Modify Tools | ****Defense Evasion**** [T1562.001(link is external)](https://attack.mitre.org/versions/v13/techniques/T1562/001/) | ****Defense Evasion**** BianLian group actors disabled Windows defender, AMSI, and Sophos SAVEnabled and SEDEenabled tamper protection services. See [Appendix: Windows PowerShell and Command Shell Activity](#_APPENDIX_:_)<br> for additional information. |\n| ****Defense Evasion**** Impair Defenses: Disable or Modify System Firewall | ****Defense Evasion**** [T1562.004(link is external)](https://attack.mitre.org/versions/v13/techniques/T1562/004/) | ****Defense Evasion**** BianLian group actors added modified firewalls to allow RDP traffic by adding new rules to the Windows firewall that allow incoming RDP traffic and enable a pre-existing Windows firewall rule group named Remote Desktop. |\n\n| **Credential Access** |     |     |\n| --- | --- | --- |\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| ****Credential Access**** OS Credential Dumping: LSASS Memory | ****Credential Access**** [T1003.001(link is external)](https://attack.mitre.org/versions/v13/techniques/T1003/001/) | ****Credential Access**** BianLian group actors accessed credential material stored in the process memory of the LSASS. See Appendix: [Windows PowerShell and Command Shell Activity](#_APPENDIX_:_)<br> for additional information. |\n| ****Credential Access**** OS Credential Dumping: NTDS | ****Credential Access**** [T1003.003(link is external)](https://attack.mitre.org/versions/v13/techniques/T1003/003/) | ****Credential Access**** BianLian group actors attempted to access or create a copy of the Active Directory domain database in order to steal credential information and to obtain other information about domain members such as devices, users, and access rights. |\n| ****Credential Access**** Unsecured Credentials: Credentials In Files | ****Credential Access**** [T1552.001(link is external)](https://attack.mitre.org/versions/v13/techniques/T1552/001/) | ****Credential Access**** BianLian group actors searched local file systems and remote file shares for files containing insecurely stored credentials. |\n\n| **Discovery** |     |     |\n| --- | --- | --- |\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| ****Discovery**** Account Discovery: Domain Account | ****Discovery**** [1087.002(link is external)](https://attack.mitre.org/versions/v13/techniques/T1087/002/) | ****Discovery**** BianLian group actors queried the domain controller to identify accounts in the Domain Admins and Domain Computers groups. This information can help adversaries determine which domain accounts exist to aid in follow-on activity. |\n| ****Discovery**** Domain Trust Discovery | ****Discovery**** [T1482(link is external)](https://attack.mitre.org/versions/v13/techniques/T1482/) | ****Discovery****<br><br>BianLian group actors used PingCastle to enumerate the AD and map trust relationships.<br><br>BianLian group actors retrieved a list of domain trust relationships used to identify lateral movement opportunities in Windows multi-domain/forest environments. |\n| ****Discovery**** File and Directory Discovery | ****Discovery**** [T1083(link is external)](https://attack.mitre.org/versions/v13/techniques/T1083/) | ****Discovery**** BianLian group used malware (system.exe) that enumerates files. |\n| ****Discovery**** Network Service Discovery | ****Discovery**** [T1046(link is external)](https://attack.mitre.org/versions/v13/techniques/T1046/) | ****Discovery**** BianLian actors used Advanced Port Scanner and SoftPerfect Network Scanner to ping computers, scan ports, and identify program versions running on ports. |\n| ****Discovery**** Network Share Discovery | ****Discovery**** [T1135(link is external)](https://attack.mitre.org/versions/v13/techniques/T1135/) | ****Discovery****<br><br>BianLian actors used SoftPerfect Network Scanner, which can discover shared folders.<br><br>BianLian group actors used SharpShares to enumerate accessible network shares in a domain. |\n| ****Discovery**** Permission Groups Discovery: Domain Groups | ****Discovery**** [T1069.002(link is external)](https://attack.mitre.org/versions/v13/techniques/T1069/002/) | ****Discovery**** BianLian group actors queried the domain controller to identify groups. |\n| ****Discovery**** Query Registry | ****Discovery**** [T1012(link is external)](https://attack.mitre.org/versions/v13/techniques/T1012/) | ****Discovery**** BianLian group used malware (system.exe) that enumerates registry. |\n| ****Discovery**** Remote System Discovery | ****Discovery**** [T1018(link is external)](https://attack.mitre.org/versions/v13/techniques/T1018/) | ****Discovery****<br><br>BianLian group actors attempted to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for lateral movement.<br><br>BianLian group actors retrieved a list of domain controllers. |\n| ****Discovery**** System Owner User Discovery | ****Discovery**** [T1033(link is external)](https://attack.mitre.org/versions/v13/techniques/T1033/) | ****Discovery**** BianLian group actors queried currently logged-in users on a machine. |\n\n| **Lateral Movement** |     |     |\n| --- | --- | --- |\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| ****Lateral Movement**** Remote Services: Remote Desktop Protocol | ****Lateral Movement**** [T1021.001(link is external)](https://attack.mitre.org/versions/v13/techniques/T1021/001/) | ****Lateral Movement**** BianLian group actors used RDP with valid accounts for lateral movement. |\n\n| **Collection** |     |     |\n| --- | --- | --- |\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| ****Collection**** Clipboard Data | ****Collection**** [T1115(link is external)](https://attack.mitre.org/versions/v13/techniques/T1115/) | ****Collection**** BianLian group actors\u2019 malware collects data stored in the clipboard from users copying information within or between applications. |\n\n| **Command and Control** |     |     |\n| --- | --- | --- |\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| ****Command and Control**** Ingress Tool Transfer | ****Command and Control**** [T1105(link is external)](https://attack.mitre.org/versions/v13/techniques/T1105/) | ****Command and Control**** BianLian group actors transferred tools or other files from an external system into a compromised environment. |\n| ****Command and Control**** Remote Access Software | ****Command and Control**** [T1219(link is external)](https://attack.mitre.org/versions/v13/techniques/T1219/) | ****Command and Control**** BianLian group actors used legitimate desktop support and remote access software, such as TeamViewer, Atera, and SplashTop, to establish an interactive command and control channel to target systems within networks. |\n\n| **Exfiltration** |     |     |\n| --- | --- | --- |\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| ****Exfiltration**** Transfer Data to Cloud Account | ****Exfiltration**** [T1537(link is external)](https://attack.mitre.org/versions/v13/techniques/T1537/) | ****Exfiltration**** BianLian group actors used Rclone to exfiltrate data to a cloud account they control on the same service to avoid typical file transfers/downloads and network-based exfiltration detection. |\n| ****Exfiltration**** Exfiltration Over Alternative Protocol | ****Exfiltration**** [T1048(link is external)](https://attack.mitre.org/versions/v13/techniques/T1048/) | ****Exfiltration**** BianLian group actors exfiltrated data via FTP. |\n| ****Exfiltration**** Exfiltration Over Web Service: Exfiltration to Cloud Storage | ****Exfiltration**** [T1567.002(link is external)](https://attack.mitre.org/versions/v13/techniques/T1567/002/) | ****Exfiltration**** BianLian group actors exfiltrated data via Mega public file-sharing service. |\n\n| **Impact** |     |     |\n| --- | --- | --- |\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| ****Impact**** Data Encrypted for Impact | ****Impact**** [T1486(link is external)](https://attack.mitre.org/versions/v13/techniques/T1486/) | ****Impact**** BianLian group actors encrypted data on target systems. |\n\n### Mitigations\n\nFBI, CISA, and ACSC recommend organizations implement the mitigations below to improve your organization\u2019s cybersecurity posture on the basis of the threat actors\u2019 activity. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats and TTPs. Visit CISA\u2019s [Cross-Sector Cybersecurity Performance Goals](https://www.cisa.gov/cpg \"https://www.cisa.gov/cpg\")\n for more information on the CPGs, including additional recommended baseline protections.\n\n*   Reduce threat of malicious actors using remote access tools by:\n    *   **Auditing remote access tools** on your network to identify currently used and/or authorized software.\n    *   **Reviewing logs for execution of remote access software** to detect abnormal use of programs running as a portable executable \\[[CPG 2.T](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n        \\].\n    *   **Using security software to detect instances of remote access** software only being loaded in memory.\n    *   **Requiring authorized remote access solutions only be used from within your network over approved remote access solutions**, such as virtual private networks (VPNs) or virtual desktop interfaces (VDIs).\n    *   **Blocking both inbound and outbound connections on common remote access software ports and protocols** at the network perimeter.\n*   **Implement application controls to manage and control execution of software**, including allowlisting remote access programs.\n    *   Application controls should prevent installation and execution of portable versions of unauthorized remote access and other software. A properly configured application allowlisting solution will block any unlisted application execution. Allowlisting is important because antivirus solutions may fail to detect the execution of malicious portable executables when the files use any combination of compression, encryption, or obfuscation.\n\nSee NSA Cybersecurity Information sheet [Enforce Signed Software Execution Policies](https://media.defense.gov/2019/Sep/09/2002180334/-1/-1/0/Enforce%20Signed%20Software%20Execution%20Policies%20-%20Copy.pdf)\n for additional guidance.\n\n*   **Strictly limit the use of RDP and other remote desktop services**. If RDP is necessary, rigorously apply best practices, for example \\[[CPG 2.W](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n    \\]:\n    *   Audit the network for systems using RDP.\n    *   Close unused RDP ports.\n    *   Enforce account lockouts after a specified number of attempts.\n    *   Apply [phishing-resistant multifactor authentication (MFA)](https://www.cisa.gov/sites/default/files/publications/fact-sheet-implementing-phishing-resistant-mfa-508c.pdf)\n        .\n    *   Log RDP login attempts.\n*   **Disable command-line and scripting activities and permissions** \\[[CPG 2.N](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n    \\]**.**\n*   **Restrict the use of PowerShell**, using Group Policy, and only grant to specific users on a case-by-case basis. Typically, only those users or administrators who manage the network or Windows operating systems (OSs) should be permitted to use PowerShell \\[[CPG 2.E](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n    \\].\n*   **Update Windows PowerShell or PowerShell Core** to the latest version and uninstall all earlier PowerShell versions. Logs from Windows PowerShell prior to version 5.0 are either non-existent or do not record enough detail to aid in enterprise monitoring and incident response activities \\[[CPG 1.E, 2.S, 2.T](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n    \\].\n*   **Enable enhanced PowerShell logging** \\[[CPG 2.T, 2.U](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n    \\].\n    *   PowerShell logs contain valuable data, including historical OS and registry interaction and possible TTPs of a threat actor\u2019s PowerShell use.\n    *   Ensure PowerShell instances, using the latest version, have module, script block, and transcription logging enabled (enhanced logging).\n    *   The two logs that record PowerShell activity are the PowerShell\u00a0Windows Event Log and the PowerShell Operational\u00a0Log. FBI and CISA recommend turning on these two Windows Event Logs with a retention period of at least 180 days. These logs should be checked on a regular basis to confirm whether the log data has been deleted or logging has been turned off. Set the storage size permitted for both logs to as large as possible.\n*   **Configure the Windows Registry to require User Account Control (UAC) approval for any PsExec operations** requiring administrator privileges to reduce the risk of lateral movement by PsExec.\n*   **Review domain controllers, servers, workstations, and active directories** for new and/or unrecognized accounts \\[[CPG 4.C](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n    \\].\n*   **Audit user accounts** with administrative privileges and configure access controls according to the principle of least privilege \\[[CPG 2.E](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n    \\].\n*   Reduce the threat of credential compromise via the following**:**\n    *   **Place domain admin accounts in the protected users\u2019 group** to prevent caching of password hashes locally.\n    *   **Implement Credential Guard for Windows 10 and Server 2016**\u00a0(Refer to [Microsoft: Manage Windows Defender Credential Guard(link is external)](https://docs.microsoft.com/en-us/windows/security/identity-protection/credential-guard/credential-guard-manage \"Manage Windows Defender Credential Guard\")\n         for more information). For Windows Server 2012R2, enable Protected Process Light for Local Security Authority (LSA).\n    *   **Refrain from storing plaintext credentials in scripts**.\n*   **Implement time-based access for accounts set at the admin level and higher** \\[[CPG 2.A, 2.E](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n    \\]**.** For example, the Just-in-Time (JIT) access method provisions privileged access when needed and can support enforcement of the principle of least privilege (as well as the Zero Trust model). This is a process where a network-wide policy is set in place to automatically disable admin accounts at the Active Directory (AD) level when the account is not in direct need. Individual users may submit their requests through an automated process that grants them access to a specified system for a set timeframe when they need to support the completion of a certain task.\n\nIn addition, FBI, CISA, and ACSC recommend network defenders apply the following mitigations to limit potential adversarial use of common system and network discovery techniques and to reduce the impact and risk of compromise by ransomware or data extortion actors:\n\n*   **Implement a recovery plan** to maintain and retain multiple copies of sensitive or proprietary data and servers in a physically separate, segmented, and secure location (e.g., hard drive, storage device, or the cloud).\n*   **Maintain offline backups of data,** and regularly maintain backup and restoration (daily or weekly at minimum). By instituting this practice, an organization minimizes the impact of disruption to business practices as they will not be as severe and/or only have irretrievable data \\[[CPG 2.R](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n    \\]. ACSC recommends organizations follow the 3-2-1 backup strategy in which organizations have three copies of data (one copy of production data and two backup copies) on two different media such as disk and tape, with one copy kept off-site for disaster recovery.\n*   **Require all accounts** with password logins (e.g., service account, admin accounts, and domain admin accounts) **to comply** with [National Institute for Standards and Technology (NIST) standards](https://pages.nist.gov/800-63-3/)\n     for developing and managing password policies.\n    *   Use longer passwords consisting of at least 15 characters \\[[CPG 2.B](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n        \\].\n    *   Store passwords in hashed format using industry-recognized password managers.\n    *   Add password user \u201csalts\u201d to shared login credentials.\n    *   Avoid reusing passwords \\[[CPG 2.C](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n        \\].\n    *   Implement multiple failed login attempt account lockouts \\[[CPG 2.G](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n        \\].\n    *   Disable password \u201chints\u201d.\n    *   Refrain from requiring password changes more frequently than once per year.  \n        **Note:** NIST guidance suggests favoring longer passwords instead of requiring regular and frequent password resets. Frequent password resets are more likely to result in users developing password \u201cpatterns\u201d cyber criminals can easily decipher.\n    *   Require administrator credentials to install software.\n*   **Require phishing-resistant multifactor authentication** for all services to the extent possible, particularly for webmail, virtual private networks, and accounts that access critical systems \\[[CPG 2.H](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n    \\].\n*   **Keep all operating systems, software, and firmware up to date.** Timely patching is one of the most efficient and cost-effective steps an organization can take to minimize its exposure to cybersecurity threats. Organizations should patch vulnerable software and hardware systems within 24 to 48 hours from vulnerability disclosure. Prioritize patching [known exploited vulnerabilities](https://www.cisa.gov/known-exploited-vulnerabilities-catalog)\n     in internet-facing systems \\[[CPG 1.E](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n    \\].\n*   **Segment networks** to prevent the spread of ransomware. Network segmentation can help prevent the spread of ransomware by controlling traffic flows between\u2014and access to\u2014various subnetworks, restricting further lateral movement \\[[CPG 2.F](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n    \\].\n*   **Identify, detect, and investigate abnormal activity and potential traversal of the indicated ransomware with a networking monitoring tool.** To aid in detecting ransomware, implement a tool that logs and reports all network traffic, including lateral movement activity on a network. Endpoint detection and response (EDR) tools are particularly useful for detecting lateral connections, as they have insight into common and uncommon network connections for each host \\[[CPG 3.A](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n    \\].\n*   **Install, regularly update, and enable real time detection for antivirus software** on all hosts.\n*   **Disable unused** **ports** \\[[CPG 2.V](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n    \\]**.**\n*   **Consider adding an email banner to emails** received from outside your organization \\[[CPG 2.M](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n    \\].\n*   **Ensure all backup data is encrypted, immutable** (i.e., cannot be altered or deleted), and covers the entire organization\u2019s data infrastructure \\[[CPG 2.K, 2.L, 2.R](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\\\n    \\].\n\n#### Validate Security Controls\n\nIn addition to applying mitigations, FBI, CISA, and ACSC recommend exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&CK for Enterprise framework in this advisory. FBI, CISA, and ACSC recommend testing your existing security controls inventory to assess how they perform against the ATT&CK techniques described in this advisory.\n\nTo get started:\n\n1.  Select an ATT&CK technique described in this advisory (see Table 2).\n2.  Align your security technologies against the technique.\n3.  Test your technologies against the technique.\n4.  Analyze your detection and prevention technologies\u2019 performance.\n5.  Repeat the process for all security technologies to obtain a set of comprehensive performance data.\n6.  Tune your security program, including people, processes, and technologies, based on the data generated by this process.\n\nFBI, CISA, and ACSC recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&CK techniques identified in this advisory.\n\n### RESOURCES\n\n*   [Stopransomware.gov](https://www.stopransomware.gov/)\n    , a whole-of-government approach with one central location for U.S. ransomware resources and alerts.\n*   [cyber.gov.au(link is external)](https://www.cyber.gov.au/)\n     for the Australian Government\u2019s central location to report cyber incidents, including ransomware, and to see advice and alerts. The site also provides ransomware advisories for businesses and organizations to help mitigate cyber threats.\n*   [CISA-Multi-State Information Sharing and Analysis Center (MS-ISAC) Joint Ransomware Guide](https://www.cisa.gov/sites/default/files/2023-01/CISA_MS-ISAC_Ransomware%20Guide_S508C.pdf)\n     for guidance on mitigating and responding to a ransomware attack\n*   For no-cost cyber hygiene services for U.S. organizations, \u00a0[Cyber Hygiene Services](https://www.cisa.gov/cyber-hygiene-services)\n     and [Ransomware Readiness Assessment(link is external)](https://github.com/cisagov/cset/releases/tag/v10.3.0.0)\n    .\n\n### Reporting\n\nThe FBI is seeking any information that can be shared, including boundary logs showing communication to and from foreign IP addresses, a sample ransom note, communications with BianLian actors, Bitcoin wallet information, decryptor files, and/or a benign sample of an encrypted file. The FBI and CISA do not encourage paying ransom, as payment does not guarantee victim files will be recovered. Furthermore, payment may also embolden adversaries to target additional organizations, encourage other criminal actors to engage in the distribution of ransomware, and/or fund illicit activities. Regardless of whether you or your organization have decided to pay the ransom, the FBI and CISA urge you to promptly report ransomware incidents to a [local FBI Field Office](https://www.fbi.gov/contact-us/field-offices)\n or CISA at [cisa.gov/report](https://us-cert.cisa.gov/report)\n. Australian organizations that have been impacted or require assistance in regard to a ransomware incident can contact ACSC via 1300 CYBER1 (1300 292 371) or by submitting a report [cyber.gov.au(link is external)](https://www.cyber.gov.au/report-and-recover/report)\n.\n\n### Acknowledgements\n\nMicrosoft and Sophos contributed to this advisory.\n\nAPPENDIX: WINDOWS PowerSHell and COMMAND SHELL ACTIVITY\n-------------------------------------------------------\n\nThrough FBI investigations as of March 2023, FBI has observed BianLian actors use the commands in Table 3. ACSC has observed BianLian actors use some of the same commands.\n\n|     |     |\n| --- | --- |Table 3: PowerShell and Windows Command Shell Activity\n| _**Command**_ | _**Use**_ |\n| --- | --- |\n| **_**Command**_** \\[Ref\\].Assembly.GetType(\u2018System.Management.Automation.AmsiUtils\u2019).GetField(\u2018amsiInitFailed\u2019,\u2019NonPublic,\\* Static\u2019).SetValue($null,$true) | **_**Use**_** Disables the AMSI on Windows. AMSI is a built-in feature on Windows 10 and newer that provides an interface for anti-malware scanners to inspect scripts prior to execution. When AMSI is disabled, malicious scripts may bypass antivirus solutions and execute undetected. |\n| **_**Command**_** cmd.exe /Q /c for /f \u201ctokens=1,2 delims= \u201c ^%A in (\u2018\u201dtasklist /fi \u201cImagename eq lsass.exe\u201d \\| find \u201clsass\u201d\u201d\u2019) do rundll32.exe C:\\\\windows\\\\System32\\\\comsvcs.dll, MiniDump ^%B \\\\Windows\\\\Temp\\\\<file>.csv full | **_**Use**_** Creates a memory dump lsass.exe\u00a0process and saves it as a CSV file[https://attack.mitre.org/versions/v12/techniques/T1003/001/(link is external)](https://attack.mitre.org/versions/v12/techniques/T1003/001/)<br>.\u00a0 BianLian actors used it to harvest credentials from lsass.exe. |\n| **_**Command**_** cmd.exe /Q /c net user <admin> /active:yes 1> \\\\\\\\127.0.0.1\\\\C$\\\\Windows\\\\Temp\\\\<folder> 2>&1 | **_**Use**_** Activates the local Administrator account. |\n| **_**Command**_** cmd.exe /Q /c net user \"<admin>\"<password> 1> \\\\\\\\127.0.0.1\\\\C$\\\\Windows\\\\Temp\\\\<folder> 2>&1 | **_**Use**_** Changes the password of the newly activated local Administrator account. |\n| **_**Command**_** cmd.exe /Q /c quser 1> \\\\\\\\127.0.0.1\\\\C$\\\\Windows\\\\Temp\\\\<folder> 2>&1 | **_**Use**_** Executes quser.exe\u00a0to query the currently logged-in users on a machine. The command is provided arguments to run quietly and exit upon completion, and the output is directed to the \\\\Windows\\\\Temp\u00a0directory. |\n| **_**Command**_** dism.exe /online /Disable-Feature /FeatureName:Windows-Defender /Remove /NoRestart | **_**Use**_** Using the Deployment Image Servicing and Management (DISM) executable file, removes the Windows Defender feature. |\n| **_**Command**_** dump.exe -no-pass -just-dc user.local/<fileserver.local>\\\\@<local\\_ip> | **_**Use**_** Executes secretsdump.py, a Portable Executable version of an Impacket tool. Used to dump password hashes from domain controllers. |\n| **_**Command**_** exp.exe -n <fileserver.local> -t <local\\_ip> | **_**Use**_** Possibly attempted exploitation of the NetLogon vulnerability (CVE-2020-1472). |\n| **_**Command**_** findstr /spin \"password\" \\*.\\* >C:\\\\Users\\\\training\\\\Music\\\\<file>.txt | **_**Use**_** Searches for the string password\u00a0in all files in the current directory and its subdirectories and puts the output to a file. |\n| **_**Command**_** ldap.exe -u user\\\\<user> -p <password> ldap://<local\\_ip> | **_**Use**_** Connects to the organization\u2019s Lightweight Directory Access Protocol (LDAP) server. |\n| **_**Command**_** logoff | **_**Use**_** Logs off the current user from a Windows session. Can be used to log off multiple users at once. |\n| **_**Command**_** mstsc | **_**Use**_** Launches Microsoft Remote Desktop Connection client application in Windows. |\n| **_**Command**_** net group /domain | **_**Use**_** Retrieves a list of all groups from the domain controller. |\n| **_**Command**_** net group 'Domain Admins' /domain | **_**Use**_** Queries the domain controller to retrieve a list of all accounts from Domain Admins\u00a0group. |\n| **_**Command**_** net group 'Domain Computers' /domain | **_**Use**_** Queries the domain controller to retrieve a list of all accounts from Domain Computers\u00a0group. |\n| **_**Command**_** net user /domain | **_**Use**_** Queries the domain controller to retrieve a list of all users in the domain. |\n| **_**Command**_** net.exe localgroup \"Remote Desktop Users\" <user> /add | **_**Use**_** Adds a user account to the local Remote Desktop Users\u00a0group. |\n| **_**Command**_** net.exe user <admin> <password> /domain | **_**Use**_** Modifies the password for the specified account. |\n| **_**Command**_** netsh.exe advfirewall firewall add rule \"name=allow RemoteDesktop\" dir=in \\* protocol=TCP localport=<port num> action=allow | **_**Use**_** Adds a new rule to the Windows firewall that allows incoming RDP traffic. |\n| **_**Command**_** netsh.exe advfirewall firewall set rule \"group=remote desktop\" new enable=Yes | **_**Use**_** Enables the pre-existing Windows firewall rule group named Remote Desktop. This rule group allows incoming RDP traffic. |\n| **_**Command**_** nltest /dclist | **_**Use**_** Retrieves a list of domain controllers. |\n| **_**Command**_** nltest /domain\\_trusts | **_**Use**_** Retrieves a list of domain trusts. |\n| **_**Command**_** ping.exe -4 -n 1 \\* | **_**Use**_** Sends a single ICMP echo request packet to all devices on the local network using the IPv4 protocol. The output of the command will show if the device is reachable or not. |\n| **_**Command**_** quser; (\\[adsisearcher\\]\"(ObjectClass=computer)\").FindAll().count;(\\[adsisearcher\\]\"(ObjectClass=user)\").FindAll().count;\\[Security.Principal.WindowsIdentity\\]::GetCurrent() \\| select name;net user \"$env:USERNAME\" /domain; (Get-WmiObject -class Win32\\_OperatingSystem).Caption; Get-WmiObject -Namespace root\\\\cimv2 -Class Win32\\_ComputerSystem; net group \"domain admins\" /domain; nltest /dclist:; nltest /DOMAIN\\_TRUSTS | **_**Use**_** Lists the current Windows identity for the logged-in user and displays the user's name. Uses the Active Directory Services Interface (ADSI) to search for all computer and user objects in the domain and returns counts of the quantities found. Lists information about the current user account from the domain, such as the user's name, description, and group memberships. Lists information about the operating system installed on the local computer. Lists information about the \"Domain Admins\" group from the domain. Lists all domain controllers in the domain. Displays information about domain trusts. |\n| **_**Command**_** reg.exe add \"HKEY\\_LOCAL\\_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Terminal \\* Server\\\\WinStations\\\\RDP-Tcp\" /v UserAuthentication /t REG\\_DWORD /d 0 /f | **_**Use**_** Adds/overwrites a new Registry value to disable user authentication for RDP connections. |\n| **_**Command**_** reg.exe add \"HKEY\\_LOCAL\\_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Terminal Server\" /\\* v fAllowToGetHelp /t REG\\_DWORD /d 1 /f | **_**Use**_** Adds/overwrites a new Registry value to allow a user to receive help from Remote Assistance. |\n| **_**Command**_** reg.exe add \"HKEY\\_LOCAL\\_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\Sophos Endpoint \\* Defense\\\\TamperProtection\\\\Config\" /t REG\\_DWORD /v SAVEnabled /d 0 /f | **_**Use**_** Adds/overwrites a new Registry value to disable tamper protection for Sophos antivirus named SAVEnabled. |\n| **_**Command**_** reg.exe add \"HKEY\\_LOCAL\\_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\Sophos Endpoint \\* Defense\\\\TamperProtection\\\\Config\" /t REG\\_DWORD /v SEDEnabled /d 0 /f | **_**Use**_** Adds/overwrites a new Registry value to disable tamper protection for Sophos antivirus named SEDEnabled. |\n| **_**Command**_** reg.exe ADD \\* HKEY\\_LOCAL\\_MACHINE\\\\SOFTWARE\\\\WOW6432Node\\\\Sophos\\\\SAVService\\\\TamperProtection /t REG\\_DWORD /v Enabled /d 0 /f | **_**Use**_** Adds/overwrites a new registry value to disable tamper protection for a Sophos antivirus service called SAVService. |\n| **_**Command**_** reg.exe copy hklm\\\\system\\\\CurrentControlSet\\\\services\\\\tvnserver \\* hklm\\\\system\\\\CurrentControlSet\\\\control\\\\safeboot\\\\network\\\\tvnserver /s /f | **_**Use**_** Copies the configuration settings for the tvnserver\u00a0service to a new location in the registry that will be used when the computer boots into Safe Mode with Networking. This allows the service to run with the same settings in Safe Mode as it does in normal mode. |\n| **_**Command**_** s.exe /threads:50 /ldap:all /verbose /outfile:c:\\\\users\\\\<user>\\\\desktop\\\\1.txt | **_**Use**_** Executes SharpShares. |\n| **_**Command**_** schtasks.exe /RU SYSTEM /create /sc ONCE /<user> /tr \"cmd.exe /crundll32.exe c:\\\\programdata\\\\netsh.dll,Entry\" /ST 04:43 | **_**Use**_** Creates a Scheduled Task run as SYSTEM\u00a0at 0443 AM. When the task is run, cmd.exe\u00a0uses crundll32.exe\u00a0to run the DLL file netsh.dll. (It is likely that netsh.dll is a malware file and not associated with netsh.) |\n| **_**Command**_** start-process PowerShell.exe -arg C:\\\\Users\\\\Public\\\\Music\\\\<file>.ps1 -WindowStyle Hidden | **_**Use**_** Executes a PowerShell script, while keeping the PowerShell window hidden from the user. |\n\n### Disclaimer\n\nThe information in this report is being provided \u201cas is\u201d for informational purposes only. FBI, CISA, and ACSC do not endorse any commercial product or service, including any subjects of analysis. Any reference to specific commercial products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by FBI, CISA, or ACSC.\n\nThis product is provided subject to this\u00a0[Notification](/notification \"Follow link\")\n\u00a0and this\u00a0[Privacy & Use](/privacy-policy \"Follow link\")\n\u00a0policy.\n\n### Tags\n\nTopics\n\n[Malware, Phishing, and Ransomware](/topics/cyber-threats-and-advisories/malware-phishing-and-ransomware)\n, [Cyber Threats and Advisories](/topics/cyber-threats-and-advisories)\n, [Critical Infrastructure Security and Resilience](/topics/critical-infrastructure-security-and-resilience)\n\nAudience\n\nSmall and Medium Businesses\n\nMITRE ATT&CK TTP\n\nCollection (TA0009), Command and Control (TA0011), Credential Access (TA0006), Defense Evasion (TA0005), Discovery (TA0007), Execution (TA0002), Exfiltration (TA0010), Impact (TA0040), Initial Access (TA0001), Lateral Movement (TA0008), Persistence (TA0003), Privilege Escalation (TA0004), Resource Development (TA0042)\n\nCo-Sealers and Partners\n\nFederal Bureau of Investigation, International\n\nPlease share your thoughts\n--------------------------\n\nWe recently updated our anonymous [product survey](https://cisasurvey.gov1.qualtrics.com/jfe/form/SV_9n4TtB8uttUPaM6?product=https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-136a)\n; we\u2019d welcome your feedback.\n\nRelated Advisories\n------------------\n\nSep 05, 2024\n\nCybersecurity Advisory | AA24-249A\n\n### [Russian Military Cyber Actors Target US and Global Critical Infrastructure](/news-events/cybersecurity-advisories/aa24-249a)\n\nAug 29, 2024\n\nCybersecurity Advisory | AA24-242A\n\n### [#StopRansomware: RansomHub Ransomware](/news-events/cybersecurity-advisories/aa24-242a)\n\nAug 28, 2024\n\nCybersecurity Advisory | AA24-241A\n\n### [Iran-based Cyber Actors Enabling Ransomware Attacks on US Organizations](/news-events/cybersecurity-advisories/aa24-241a)\n\nJul 25, 2024\n\nCybersecurity Advisory | AA24-207A\n\n### [North Korea Cyber Group Conducts Global Espionage Campaign to Advance Regime\u2019s Military and Nuclear Programs](/news-events/cybersecurity-advisories/aa24-207a)\n\n|     |     |\n| --- | --- |\n|     |     |\n\n|     |     |\n| --- | --- |\n|     |     |",
  "metadata": {
    "title": "#StopRansomware: BianLian Ransomware Group | CISALocksearchsearch(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)(link is external)",
    "language": "en",
    "ogTitle": "#StopRansomware: BianLian Ransomware Group | CISA",
    "ogUrl": "https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-136a",
    "ogLocaleAlternate": [],
    "ogSiteName": "Cybersecurity and Infrastructure Security Agency CISA",
    "sourceURL": "https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-136a",
    "statusCode": 200
  }
}
Successfully scraped markdown for URL: https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-136a
Preparing prompt for summarization...
Query: encryptor.exe malware
Scraping JSON (first 500 characters): {
  "query": "encryptor.exe malware",
  "results": [
    {
      "title": "#StopRansomware: BianLian Ransomware Group | CISA",
      "url": "https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-136a",
      "content": "[Skip to main content](#main)\n\n![Dot gov](https://www.cisa.gov/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-dot-gov.svg)\n\n**Official websites use .gov**  \nA **.gov** website belongs to an official government organization in the United States.\n\n![HTTPS]...
Error during summarization: finish_reason: SAFETY
index: 0
safety_ratings {
  category: HARM_CATEGORY_SEXUALLY_EXPLICIT
  probability: NEGLIGIBLE
}
safety_ratings {
  category: HARM_CATEGORY_HATE_SPEECH
  probability: NEGLIGIBLE
}
safety_ratings {
  category: HARM_CATEGORY_HARASSMENT
  probability: NEGLIGIBLE
}
safety_ratings {
  category: HARM_CATEGORY_DANGEROUS_CONTENT
  probability: MEDIUM
}
citation_metadata {
  citation_sources {
    start_index: 1817
    end_index: 1948
    uri: "https://research.loginsoft.com/threat-research/ransomware-watch-q1-2023-highlights/"
    license_: ""
  }
}

Traceback (most recent call last):
  File "C:\Users\johnr\Documents\tools\agents\saint_con\pidgy\tools\website_crawler\crawl_website.py", line 176, in summarize_results       
    response = chat_session.send_message(prompt)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\johnr\Documents\tools\agents\saint_con\pidgy\myenv\Lib\site-packages\google\generativeai\generative_models.py", line 588, in send_message
    self._check_response(response=response, stream=stream)
  File "C:\Users\johnr\Documents\tools\agents\saint_con\pidgy\myenv\Lib\site-packages\google\generativeai\generative_models.py", line 616, in _check_response
    raise generation_types.StopCandidateException(response.candidates[0])
google.generativeai.types.generation_types.StopCandidateException: finish_reason: SAFETY
index: 0
safety_ratings {
  category: HARM_CATEGORY_SEXUALLY_EXPLICIT
  probability: NEGLIGIBLE
}
safety_ratings {
  category: HARM_CATEGORY_HATE_SPEECH
  probability: NEGLIGIBLE
}
safety_ratings {
  category: HARM_CATEGORY_HARASSMENT
  probability: NEGLIGIBLE
}
safety_ratings {
  category: HARM_CATEGORY_DANGEROUS_CONTENT
  probability: MEDIUM
}
citation_metadata {
  citation_sources {
    start_index: 1817
    end_index: 1948
    uri: "https://research.loginsoft.com/threat-research/ransomware-watch-q1-2023-highlights/"
    license_: ""
  }
}